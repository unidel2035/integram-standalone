import{a as t}from"./index-CcrxTH1M.js";async function e(){const t=localStorage.getItem("integram_session");if(!t)return null;try{return JSON.parse(t)}catch(e){return null}}async function a(){const t={},a=await e();if(a){const e=a.database||a.authDatabase;t[e]={token:a.token,xsrf:a.xsrfToken,userId:a.userId,userName:a.userName,database:e}}const o=["ddadmin","my","a2025"];for(const e of o){const a=localStorage.getItem(`${e}_token`);a&&!t[e]&&(t[e]={token:a,xsrf:localStorage.getItem(`${e}_xsrf`),userId:localStorage.getItem(`${e}_id`),userName:localStorage.getItem(`${e}_user`),database:e})}return t}const o={isAuthenticated:function(){const t=localStorage.getItem("unified_auth_session_id"),e=localStorage.getItem("integram_session");return!(!t&&!e)},getSession:e,getTokenForDatabase:async function(t){const a=await e();if(!a)return null;if(a.database===t||a.authDatabase===t)return{token:a.token,xsrf:a.xsrfToken,userId:a.userId,userName:a.userName,database:a.database};const o=localStorage.getItem(`${t}_token`),n=localStorage.getItem(`${t}_xsrf`),s=localStorage.getItem(`${t}_id`),r=localStorage.getItem(`${t}_user`);return o?{token:o,xsrf:n,userId:s,userName:r,database:t}:null},getAllTokens:a,getAvailableDatabases:async function(){const t=await a();return Object.keys(t)},logout:async function(){localStorage.removeItem("unified_auth_session_id"),localStorage.removeItem("integram_session");try{await t.post("/api/auth/logout")}catch(e){}},login:async function(e){return(await t.post("/api/auth/login",e)).data},verifyToken:async function(e){return(await t.post("/api/auth/verify",{token:e})).data}};export{o as u};
