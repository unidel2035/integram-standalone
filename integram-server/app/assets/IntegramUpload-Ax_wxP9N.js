import{I as An}from"./IntegramBreadcrumb-bt1ieLIm.js";import{_ as Pn,y as Q,u as Mn,c as $,A as S,w as U,L as jt,D as Wt,I as He,d as R,J as Gt,U as _t,o as L,b as se,a as c,h as Ee,t as j,f as ke,F as wt,r as St,g as Ve,j as Et,P as Vn}from"./index-BrdfL8RF.js";import{u as Jt}from"./useIntegramSession-BGgEhYZh.js";import{i as Kt}from"./integramApiClient-C3_j8SPw.js";import{u as qt}from"./useTimer-BBbej_UZ.js";import"./index-B9ygI19o.js";import"./unifiedAuthService-xCuNj-Bd.js";/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Zt(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);e&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(i,o).enumerable})),n.push.apply(n,t)}return n}function me(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Zt(Object(n),!0).forEach(function(t){Rn(i,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(n,t))})}return i}function rt(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?rt=function(e){return typeof e}:rt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rt(i)}function Rn(i,e,n){return e in i?Object.defineProperty(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}function be(){return be=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(i[t]=n[t])}return i},be.apply(this,arguments)}function Ln(i,e){if(i==null)return{};var n={},t=Object.keys(i),o,l;for(l=0;l<t.length;l++)o=t[l],!(e.indexOf(o)>=0)&&(n[o]=i[o]);return n}function Bn(i,e){if(i==null)return{};var n=Ln(i,e),t,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(i);for(o=0;o<l.length;o++)t=l[o],!(e.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(i,t)&&(n[t]=i[t])}return n}var Un="1.15.6";function ve(i){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(i)}var ye=ve(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),$e=ve(/Edge/i),Qt=ve(/firefox/i),Je=ve(/safari/i)&&!ve(/chrome/i)&&!ve(/android/i),Rt=ve(/iP(ad|od|hone)/i),rn=ve(/chrome/i)&&ve(/android/i),sn={capture:!1,passive:!1};function x(i,e,n){i.addEventListener(e,n,!ye&&sn)}function D(i,e,n){i.removeEventListener(e,n,!ye&&sn)}function ft(i,e){if(e){if(e[0]===">"&&(e=e.substring(1)),i)try{if(i.matches)return i.matches(e);if(i.msMatchesSelector)return i.msMatchesSelector(e);if(i.webkitMatchesSelector)return i.webkitMatchesSelector(e)}catch{return!1}return!1}}function dn(i){return i.host&&i!==document&&i.host.nodeType?i.host:i.parentNode}function ue(i,e,n,t){if(i){n=n||document;do{if(e!=null&&(e[0]===">"?i.parentNode===n&&ft(i,e):ft(i,e))||t&&i===n)return i;if(i===n)break}while(i=dn(i))}return null}var $t=/\s+/g;function ne(i,e,n){if(i&&e)if(i.classList)i.classList[n?"add":"remove"](e);else{var t=(" "+i.className+" ").replace($t," ").replace(" "+e+" "," ");i.className=(t+(n?" "+e:"")).replace($t," ")}}function b(i,e,n){var t=i&&i.style;if(t){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(i,""):i.currentStyle&&(n=i.currentStyle),e===void 0?n:n[e];!(e in t)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),t[e]=n+(typeof n=="string"?"":"px")}}function Xe(i,e){var n="";if(typeof i=="string")n=i;else do{var t=b(i,"transform");t&&t!=="none"&&(n=t+" "+n)}while(!e&&(i=i.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function un(i,e,n){if(i){var t=i.getElementsByTagName(e),o=0,l=t.length;if(n)for(;o<l;o++)n(t[o],o);return t}return[]}function fe(){var i=document.scrollingElement;return i||document.documentElement}function Y(i,e,n,t,o){if(!(!i.getBoundingClientRect&&i!==window)){var l,a,r,s,d,p,m;if(i!==window&&i.parentNode&&i!==fe()?(l=i.getBoundingClientRect(),a=l.top,r=l.left,s=l.bottom,d=l.right,p=l.height,m=l.width):(a=0,r=0,s=window.innerHeight,d=window.innerWidth,p=window.innerHeight,m=window.innerWidth),(e||n)&&i!==window&&(o=o||i.parentNode,!ye))do if(o&&o.getBoundingClientRect&&(b(o,"transform")!=="none"||n&&b(o,"position")!=="static")){var _=o.getBoundingClientRect();a-=_.top+parseInt(b(o,"border-top-width")),r-=_.left+parseInt(b(o,"border-left-width")),s=a+l.height,d=r+l.width;break}while(o=o.parentNode);if(t&&i!==window){var C=Xe(o||i),E=C&&C.a,w=C&&C.d;C&&(a/=w,r/=E,m/=E,p/=w,s=a+p,d=r+m)}return{top:a,left:r,bottom:s,right:d,width:m,height:p}}}function en(i,e,n){for(var t=Ce(i,!0),o=Y(i)[e];t;){var l=Y(t)[n],a=void 0;if(a=o>=l,!a)return t;if(t===fe())break;t=Ce(t,!1)}return!1}function Ye(i,e,n,t){for(var o=0,l=0,a=i.children;l<a.length;){if(a[l].style.display!=="none"&&a[l]!==v.ghost&&(t||a[l]!==v.dragged)&&ue(a[l],n.draggable,i,!1)){if(o===e)return a[l];o++}l++}return null}function Lt(i,e){for(var n=i.lastElementChild;n&&(n===v.ghost||b(n,"display")==="none"||e&&!ft(n,e));)n=n.previousElementSibling;return n||null}function ae(i,e){var n=0;if(!i||!i.parentNode)return-1;for(;i=i.previousElementSibling;)i.nodeName.toUpperCase()!=="TEMPLATE"&&i!==v.clone&&(!e||ft(i,e))&&n++;return n}function tn(i){var e=0,n=0,t=fe();if(i)do{var o=Xe(i),l=o.a,a=o.d;e+=i.scrollLeft*l,n+=i.scrollTop*a}while(i!==t&&(i=i.parentNode));return[e,n]}function Xn(i,e){for(var n in i)if(i.hasOwnProperty(n)){for(var t in e)if(e.hasOwnProperty(t)&&e[t]===i[n][t])return Number(n)}return-1}function Ce(i,e){if(!i||!i.getBoundingClientRect)return fe();var n=i,t=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=b(n);if(n.clientWidth<n.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return fe();if(t||e)return n;t=!0}}while(n=n.parentNode);return fe()}function Yn(i,e){if(i&&e)for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);return i}function Dt(i,e){return Math.round(i.top)===Math.round(e.top)&&Math.round(i.left)===Math.round(e.left)&&Math.round(i.height)===Math.round(e.height)&&Math.round(i.width)===Math.round(e.width)}var Ke;function cn(i,e){return function(){if(!Ke){var n=arguments,t=this;n.length===1?i.call(t,n[0]):i.apply(t,n),Ke=setTimeout(function(){Ke=void 0},e)}}}function zn(){clearTimeout(Ke),Ke=void 0}function fn(i,e,n){i.scrollLeft+=e,i.scrollTop+=n}function mn(i){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(i).cloneNode(!0):n?n(i).clone(!0)[0]:i.cloneNode(!0)}function pn(i,e,n){var t={};return Array.from(i.children).forEach(function(o){var l,a,r,s;if(!(!ue(o,e.draggable,i,!1)||o.animated||o===n)){var d=Y(o);t.left=Math.min((l=t.left)!==null&&l!==void 0?l:1/0,d.left),t.top=Math.min((a=t.top)!==null&&a!==void 0?a:1/0,d.top),t.right=Math.max((r=t.right)!==null&&r!==void 0?r:-1/0,d.right),t.bottom=Math.max((s=t.bottom)!==null&&s!==void 0?s:-1/0,d.bottom)}}),t.width=t.right-t.left,t.height=t.bottom-t.top,t.x=t.left,t.y=t.top,t}var te="Sortable"+new Date().getTime();function Hn(){var i=[],e;return{captureAnimationState:function(){if(i=[],!!this.options.animation){var t=[].slice.call(this.el.children);t.forEach(function(o){if(!(b(o,"display")==="none"||o===v.ghost)){i.push({target:o,rect:Y(o)});var l=me({},i[i.length-1].rect);if(o.thisAnimationDuration){var a=Xe(o,!0);a&&(l.top-=a.f,l.left-=a.e)}o.fromRect=l}})}},addAnimationState:function(t){i.push(t)},removeAnimationState:function(t){i.splice(Xn(i,{target:t}),1)},animateAll:function(t){var o=this;if(!this.options.animation){clearTimeout(e),typeof t=="function"&&t();return}var l=!1,a=0;i.forEach(function(r){var s=0,d=r.target,p=d.fromRect,m=Y(d),_=d.prevFromRect,C=d.prevToRect,E=r.rect,w=Xe(d,!0);w&&(m.top-=w.f,m.left-=w.e),d.toRect=m,d.thisAnimationDuration&&Dt(_,m)&&!Dt(p,m)&&(E.top-m.top)/(E.left-m.left)===(p.top-m.top)/(p.left-m.left)&&(s=Wn(E,_,C,o.options)),Dt(m,p)||(d.prevFromRect=p,d.prevToRect=m,s||(s=o.options.animation),o.animate(d,E,m,s)),s&&(l=!0,a=Math.max(a,s),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},s),d.thisAnimationDuration=s)}),clearTimeout(e),l?e=setTimeout(function(){typeof t=="function"&&t()},a):typeof t=="function"&&t(),i=[]},animate:function(t,o,l,a){if(a){b(t,"transition",""),b(t,"transform","");var r=Xe(this.el),s=r&&r.a,d=r&&r.d,p=(o.left-l.left)/(s||1),m=(o.top-l.top)/(d||1);t.animatingX=!!p,t.animatingY=!!m,b(t,"transform","translate3d("+p+"px,"+m+"px,0)"),this.forRepaintDummy=jn(t),b(t,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),b(t,"transform","translate3d(0,0,0)"),typeof t.animated=="number"&&clearTimeout(t.animated),t.animated=setTimeout(function(){b(t,"transition",""),b(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1},a)}}}}function jn(i){return i.offsetWidth}function Wn(i,e,n,t){return Math.sqrt(Math.pow(e.top-i.top,2)+Math.pow(e.left-i.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*t.animation}var Re=[],xt={initializeByDefault:!0},et={mount:function(e){for(var n in xt)xt.hasOwnProperty(n)&&!(n in e)&&(e[n]=xt[n]);Re.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Re.push(e)},pluginEvent:function(e,n,t){var o=this;this.eventCanceled=!1,t.cancel=function(){o.eventCanceled=!0};var l=e+"Global";Re.forEach(function(a){n[a.pluginName]&&(n[a.pluginName][l]&&n[a.pluginName][l](me({sortable:n},t)),n.options[a.pluginName]&&n[a.pluginName][e]&&n[a.pluginName][e](me({sortable:n},t)))})},initializePlugins:function(e,n,t,o){Re.forEach(function(r){var s=r.pluginName;if(!(!e.options[s]&&!r.initializeByDefault)){var d=new r(e,n,e.options);d.sortable=e,d.options=e.options,e[s]=d,be(t,d.defaults)}});for(var l in e.options)if(e.options.hasOwnProperty(l)){var a=this.modifyOption(e,l,e.options[l]);typeof a<"u"&&(e.options[l]=a)}},getEventProperties:function(e,n){var t={};return Re.forEach(function(o){typeof o.eventProperties=="function"&&be(t,o.eventProperties.call(n[o.pluginName],e))}),t},modifyOption:function(e,n,t){var o;return Re.forEach(function(l){e[l.pluginName]&&l.optionListeners&&typeof l.optionListeners[n]=="function"&&(o=l.optionListeners[n].call(e[l.pluginName],t))}),o}};function Gn(i){var e=i.sortable,n=i.rootEl,t=i.name,o=i.targetEl,l=i.cloneEl,a=i.toEl,r=i.fromEl,s=i.oldIndex,d=i.newIndex,p=i.oldDraggableIndex,m=i.newDraggableIndex,_=i.originalEvent,C=i.putSortable,E=i.extraEventProperties;if(e=e||n&&n[te],!!e){var w,I=e.options,G="on"+t.charAt(0).toUpperCase()+t.substr(1);window.CustomEvent&&!ye&&!$e?w=new CustomEvent(t,{bubbles:!0,cancelable:!0}):(w=document.createEvent("Event"),w.initEvent(t,!0,!0)),w.to=a||n,w.from=r||n,w.item=o||n,w.clone=l,w.oldIndex=s,w.newIndex=d,w.oldDraggableIndex=p,w.newDraggableIndex=m,w.originalEvent=_,w.pullMode=C?C.lastPutMode:void 0;var P=me(me({},E),et.getEventProperties(t,e));for(var M in P)w[M]=P[M];n&&n.dispatchEvent(w),I[G]&&I[G].call(e,w)}}var Jn=["evt"],ee=function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=t.evt,l=Bn(t,Jn);et.pluginEvent.bind(v)(e,n,me({dragEl:f,parentEl:B,ghostEl:y,rootEl:A,nextEl:Ae,lastDownEl:st,cloneEl:V,cloneHidden:xe,dragStarted:je,putSortable:W,activeSortable:v.active,originalEvent:o,oldIndex:Ue,oldDraggableIndex:qe,newIndex:ie,newDraggableIndex:De,hideGhostForTarget:bn,unhideGhostForTarget:yn,cloneNowHidden:function(){xe=!0},cloneNowShown:function(){xe=!1},dispatchSortableEvent:function(r){q({sortable:n,name:r,originalEvent:o})}},l))};function q(i){Gn(me({putSortable:W,cloneEl:V,targetEl:f,rootEl:A,oldIndex:Ue,oldDraggableIndex:qe,newIndex:ie,newDraggableIndex:De},i))}var f,B,y,A,Ae,st,V,xe,Ue,ie,qe,De,it,W,Be=!1,mt=!1,pt=[],Fe,de,Ct,Tt,nn,on,je,Le,Ze,Qe=!1,ot=!1,dt,J,It=[],At=!1,ht=[],vt=typeof document<"u",lt=Rt,ln=$e||ye?"cssFloat":"float",Kn=vt&&!rn&&!Rt&&"draggable"in document.createElement("div"),hn=(function(){if(vt){if(ye)return!1;var i=document.createElement("x");return i.style.cssText="pointer-events:auto",i.style.pointerEvents==="auto"}})(),gn=function(e,n){var t=b(e),o=parseInt(t.width)-parseInt(t.paddingLeft)-parseInt(t.paddingRight)-parseInt(t.borderLeftWidth)-parseInt(t.borderRightWidth),l=Ye(e,0,n),a=Ye(e,1,n),r=l&&b(l),s=a&&b(a),d=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+Y(l).width,p=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+Y(a).width;if(t.display==="flex")return t.flexDirection==="column"||t.flexDirection==="column-reverse"?"vertical":"horizontal";if(t.display==="grid")return t.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&r.float&&r.float!=="none"){var m=r.float==="left"?"left":"right";return a&&(s.clear==="both"||s.clear===m)?"vertical":"horizontal"}return l&&(r.display==="block"||r.display==="flex"||r.display==="table"||r.display==="grid"||d>=o&&t[ln]==="none"||a&&t[ln]==="none"&&d+p>o)?"vertical":"horizontal"},qn=function(e,n,t){var o=t?e.left:e.top,l=t?e.right:e.bottom,a=t?e.width:e.height,r=t?n.left:n.top,s=t?n.right:n.bottom,d=t?n.width:n.height;return o===r||l===s||o+a/2===r+d/2},Zn=function(e,n){var t;return pt.some(function(o){var l=o[te].options.emptyInsertThreshold;if(!(!l||Lt(o))){var a=Y(o),r=e>=a.left-l&&e<=a.right+l,s=n>=a.top-l&&n<=a.bottom+l;if(r&&s)return t=o}}),t},vn=function(e){function n(l,a){return function(r,s,d,p){var m=r.options.group.name&&s.options.group.name&&r.options.group.name===s.options.group.name;if(l==null&&(a||m))return!0;if(l==null||l===!1)return!1;if(a&&l==="clone")return l;if(typeof l=="function")return n(l(r,s,d,p),a)(r,s,d,p);var _=(a?r:s).options.group.name;return l===!0||typeof l=="string"&&l===_||l.join&&l.indexOf(_)>-1}}var t={},o=e.group;(!o||rt(o)!="object")&&(o={name:o}),t.name=o.name,t.checkPull=n(o.pull,!0),t.checkPut=n(o.put),t.revertClone=o.revertClone,e.group=t},bn=function(){!hn&&y&&b(y,"display","none")},yn=function(){!hn&&y&&b(y,"display","")};vt&&!rn&&document.addEventListener("click",function(i){if(mt)return i.preventDefault(),i.stopPropagation&&i.stopPropagation(),i.stopImmediatePropagation&&i.stopImmediatePropagation(),mt=!1,!1},!0);var Ne=function(e){if(f){e=e.touches?e.touches[0]:e;var n=Zn(e.clientX,e.clientY);if(n){var t={};for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.target=t.rootEl=n,t.preventDefault=void 0,t.stopPropagation=void 0,n[te]._onDragOver(t)}}},Qn=function(e){f&&f.parentNode[te]._isOutsideThisEl(e.target)};function v(i,e){if(!(i&&i.nodeType&&i.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(i));this.el=i,this.options=e=be({},e),i[te]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(i.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return gn(i,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,r){a.setData("Text",r.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:v.supportPointer!==!1&&"PointerEvent"in window&&(!Je||Rt),emptyInsertThreshold:5};et.initializePlugins(this,i,n);for(var t in n)!(t in e)&&(e[t]=n[t]);vn(e);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=e.forceFallback?!1:Kn,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?x(i,"pointerdown",this._onTapStart):(x(i,"mousedown",this._onTapStart),x(i,"touchstart",this._onTapStart)),this.nativeDraggable&&(x(i,"dragover",this),x(i,"dragenter",this)),pt.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),be(this,Hn())}v.prototype={constructor:v,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Le=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,f):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,t=this.el,o=this.options,l=o.preventOnFilter,a=e.type,r=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,s=(r||e).target,d=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,p=o.filter;if(ai(t),!f&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||o.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&Je&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=ue(s,o.draggable,t,!1),!(s&&s.animated)&&st!==s)){if(Ue=ae(s),qe=ae(s,o.draggable),typeof p=="function"){if(p.call(this,e,s,this)){q({sortable:n,rootEl:d,name:"filter",targetEl:s,toEl:t,fromEl:t}),ee("filter",n,{evt:e}),l&&e.preventDefault();return}}else if(p&&(p=p.split(",").some(function(m){if(m=ue(d,m.trim(),t,!1),m)return q({sortable:n,rootEl:m,name:"filter",targetEl:s,fromEl:t,toEl:t}),ee("filter",n,{evt:e}),!0}),p)){l&&e.preventDefault();return}o.handle&&!ue(d,o.handle,t,!1)||this._prepareDragStart(e,r,s)}}},_prepareDragStart:function(e,n,t){var o=this,l=o.el,a=o.options,r=l.ownerDocument,s;if(t&&!f&&t.parentNode===l){var d=Y(t);if(A=l,f=t,B=f.parentNode,Ae=f.nextSibling,st=t,it=a.group,v.dragged=f,Fe={target:f,clientX:(n||e).clientX,clientY:(n||e).clientY},nn=Fe.clientX-d.left,on=Fe.clientY-d.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,f.style["will-change"]="all",s=function(){if(ee("delayEnded",o,{evt:e}),v.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!Qt&&o.nativeDraggable&&(f.draggable=!0),o._triggerDragStart(e,n),q({sortable:o,name:"choose",originalEvent:e}),ne(f,a.chosenClass,!0)},a.ignore.split(",").forEach(function(p){un(f,p.trim(),Ot)}),x(r,"dragover",Ne),x(r,"mousemove",Ne),x(r,"touchmove",Ne),a.supportPointer?(x(r,"pointerup",o._onDrop),!this.nativeDraggable&&x(r,"pointercancel",o._onDrop)):(x(r,"mouseup",o._onDrop),x(r,"touchend",o._onDrop),x(r,"touchcancel",o._onDrop)),Qt&&this.nativeDraggable&&(this.options.touchStartThreshold=4,f.draggable=!0),ee("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||n)&&(!this.nativeDraggable||!($e||ye))){if(v.eventCanceled){this._onDrop();return}a.supportPointer?(x(r,"pointerup",o._disableDelayedDrag),x(r,"pointercancel",o._disableDelayedDrag)):(x(r,"mouseup",o._disableDelayedDrag),x(r,"touchend",o._disableDelayedDrag),x(r,"touchcancel",o._disableDelayedDrag)),x(r,"mousemove",o._delayedDragTouchMoveHandler),x(r,"touchmove",o._delayedDragTouchMoveHandler),a.supportPointer&&x(r,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(s,a.delay)}else s()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){f&&Ot(f),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;D(e,"mouseup",this._disableDelayedDrag),D(e,"touchend",this._disableDelayedDrag),D(e,"touchcancel",this._disableDelayedDrag),D(e,"pointerup",this._disableDelayedDrag),D(e,"pointercancel",this._disableDelayedDrag),D(e,"mousemove",this._delayedDragTouchMoveHandler),D(e,"touchmove",this._delayedDragTouchMoveHandler),D(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?x(document,"pointermove",this._onTouchMove):n?x(document,"touchmove",this._onTouchMove):x(document,"mousemove",this._onTouchMove):(x(f,"dragend",this),x(A,"dragstart",this._onDragStart));try{document.selection?ut(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(Be=!1,A&&f){ee("dragStarted",this,{evt:n}),this.nativeDraggable&&x(document,"dragover",Qn);var t=this.options;!e&&ne(f,t.dragClass,!1),ne(f,t.ghostClass,!0),v.active=this,e&&this._appendGhost(),q({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(de){this._lastX=de.clientX,this._lastY=de.clientY,bn();for(var e=document.elementFromPoint(de.clientX,de.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(de.clientX,de.clientY),e!==n);)n=e;if(f.parentNode[te]._isOutsideThisEl(e),n)do{if(n[te]){var t=void 0;if(t=n[te]._onDragOver({clientX:de.clientX,clientY:de.clientY,target:e,rootEl:n}),t&&!this.options.dragoverBubble)break}e=n}while(n=dn(n));yn()}},_onTouchMove:function(e){if(Fe){var n=this.options,t=n.fallbackTolerance,o=n.fallbackOffset,l=e.touches?e.touches[0]:e,a=y&&Xe(y,!0),r=y&&a&&a.a,s=y&&a&&a.d,d=lt&&J&&tn(J),p=(l.clientX-Fe.clientX+o.x)/(r||1)+(d?d[0]-It[0]:0)/(r||1),m=(l.clientY-Fe.clientY+o.y)/(s||1)+(d?d[1]-It[1]:0)/(s||1);if(!v.active&&!Be){if(t&&Math.max(Math.abs(l.clientX-this._lastX),Math.abs(l.clientY-this._lastY))<t)return;this._onDragStart(e,!0)}if(y){a?(a.e+=p-(Ct||0),a.f+=m-(Tt||0)):a={a:1,b:0,c:0,d:1,e:p,f:m};var _="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");b(y,"webkitTransform",_),b(y,"mozTransform",_),b(y,"msTransform",_),b(y,"transform",_),Ct=p,Tt=m,de=l}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!y){var e=this.options.fallbackOnBody?document.body:A,n=Y(f,!0,lt,!0,e),t=this.options;if(lt){for(J=e;b(J,"position")==="static"&&b(J,"transform")==="none"&&J!==document;)J=J.parentNode;J!==document.body&&J!==document.documentElement?(J===document&&(J=fe()),n.top+=J.scrollTop,n.left+=J.scrollLeft):J=fe(),It=tn(J)}y=f.cloneNode(!0),ne(y,t.ghostClass,!1),ne(y,t.fallbackClass,!0),ne(y,t.dragClass,!0),b(y,"transition",""),b(y,"transform",""),b(y,"box-sizing","border-box"),b(y,"margin",0),b(y,"top",n.top),b(y,"left",n.left),b(y,"width",n.width),b(y,"height",n.height),b(y,"opacity","0.8"),b(y,"position",lt?"absolute":"fixed"),b(y,"zIndex","100000"),b(y,"pointerEvents","none"),v.ghost=y,e.appendChild(y),b(y,"transform-origin",nn/parseInt(y.style.width)*100+"% "+on/parseInt(y.style.height)*100+"%")}},_onDragStart:function(e,n){var t=this,o=e.dataTransfer,l=t.options;if(ee("dragStart",this,{evt:e}),v.eventCanceled){this._onDrop();return}ee("setupClone",this),v.eventCanceled||(V=mn(f),V.removeAttribute("id"),V.draggable=!1,V.style["will-change"]="",this._hideClone(),ne(V,this.options.chosenClass,!1),v.clone=V),t.cloneId=ut(function(){ee("clone",t),!v.eventCanceled&&(t.options.removeCloneOnHide||A.insertBefore(V,f),t._hideClone(),q({sortable:t,name:"clone"}))}),!n&&ne(f,l.dragClass,!0),n?(mt=!0,t._loopId=setInterval(t._emulateDragOver,50)):(D(document,"mouseup",t._onDrop),D(document,"touchend",t._onDrop),D(document,"touchcancel",t._onDrop),o&&(o.effectAllowed="move",l.setData&&l.setData.call(t,o,f)),x(document,"drop",t),b(f,"transform","translateZ(0)")),Be=!0,t._dragStartId=ut(t._dragStarted.bind(t,n,e)),x(document,"selectstart",t),je=!0,window.getSelection().removeAllRanges(),Je&&b(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,t=e.target,o,l,a,r=this.options,s=r.group,d=v.active,p=it===s,m=r.sort,_=W||d,C,E=this,w=!1;if(At)return;function I(ge,bt){ee(ge,E,me({evt:e,isOwner:p,axis:C?"vertical":"horizontal",revert:a,dragRect:o,targetRect:l,canSort:m,fromSortable:_,target:t,completed:P,onMove:function(tt,nt){return at(A,n,f,o,tt,Y(tt),e,nt)},changed:M},bt))}function G(){I("dragOverAnimationCapture"),E.captureAnimationState(),E!==_&&_.captureAnimationState()}function P(ge){return I("dragOverCompleted",{insertion:ge}),ge&&(p?d._hideClone():d._showClone(E),E!==_&&(ne(f,W?W.options.ghostClass:d.options.ghostClass,!1),ne(f,r.ghostClass,!0)),W!==E&&E!==v.active?W=E:E===v.active&&W&&(W=null),_===E&&(E._ignoreWhileAnimating=t),E.animateAll(function(){I("dragOverAnimationComplete"),E._ignoreWhileAnimating=null}),E!==_&&(_.animateAll(),_._ignoreWhileAnimating=null)),(t===f&&!f.animated||t===n&&!t.animated)&&(Le=null),!r.dragoverBubble&&!e.rootEl&&t!==document&&(f.parentNode[te]._isOutsideThisEl(e.target),!ge&&Ne(e)),!r.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),w=!0}function M(){ie=ae(f),De=ae(f,r.draggable),q({sortable:E,name:"change",toEl:n,newIndex:ie,newDraggableIndex:De,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),t=ue(t,r.draggable,n,!0),I("dragOver"),v.eventCanceled)return w;if(f.contains(e.target)||t.animated&&t.animatingX&&t.animatingY||E._ignoreWhileAnimating===t)return P(!1);if(mt=!1,d&&!r.disabled&&(p?m||(a=B!==A):W===this||(this.lastPutMode=it.checkPull(this,d,f,e))&&s.checkPut(this,d,f,e))){if(C=this._getDirection(e,t)==="vertical",o=Y(f),I("dragOverValid"),v.eventCanceled)return w;if(a)return B=A,G(),this._hideClone(),I("revert"),v.eventCanceled||(Ae?A.insertBefore(f,Ae):A.appendChild(f)),P(!0);var k=Lt(n,r.draggable);if(!k||ni(e,C,this)&&!k.animated){if(k===f)return P(!1);if(k&&n===e.target&&(t=k),t&&(l=Y(t)),at(A,n,f,o,t,l,e,!!t)!==!1)return G(),k&&k.nextSibling?n.insertBefore(f,k.nextSibling):n.appendChild(f),B=n,M(),P(!0)}else if(k&&ti(e,C,this)){var u=Ye(n,0,r,!0);if(u===f)return P(!1);if(t=u,l=Y(t),at(A,n,f,o,t,l,e,!1)!==!1)return G(),n.insertBefore(f,u),B=n,M(),P(!0)}else if(t.parentNode===n){l=Y(t);var F=0,H,z=f.parentNode!==n,K=!qn(f.animated&&f.toRect||o,t.animated&&t.toRect||l,C),pe=C?"top":"left",oe=en(t,"top","top")||en(f,"top","top"),_e=oe?oe.scrollTop:void 0;Le!==t&&(H=l[pe],Qe=!1,ot=!K&&r.invertSwap||z),F=ii(e,t,l,C,K?1:r.swapThreshold,r.invertedSwapThreshold==null?r.swapThreshold:r.invertedSwapThreshold,ot,Le===t);var le;if(F!==0){var he=ae(f);do he-=F,le=B.children[he];while(le&&(b(le,"display")==="none"||le===y))}if(F===0||le===t)return P(!1);Le=t,Ze=F;var we=t.nextElementSibling,ce=!1;ce=F===1;var Te=at(A,n,f,o,t,l,e,ce);if(Te!==!1)return(Te===1||Te===-1)&&(ce=Te===1),At=!0,setTimeout(ei,30),G(),ce&&!we?n.appendChild(f):t.parentNode.insertBefore(f,ce?we:t),oe&&fn(oe,0,_e-oe.scrollTop),B=f.parentNode,H!==void 0&&!ot&&(dt=Math.abs(H-Y(t)[pe])),M(),P(!0)}if(n.contains(f))return P(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){D(document,"mousemove",this._onTouchMove),D(document,"touchmove",this._onTouchMove),D(document,"pointermove",this._onTouchMove),D(document,"dragover",Ne),D(document,"mousemove",Ne),D(document,"touchmove",Ne)},_offUpEvents:function(){var e=this.el.ownerDocument;D(e,"mouseup",this._onDrop),D(e,"touchend",this._onDrop),D(e,"pointerup",this._onDrop),D(e,"pointercancel",this._onDrop),D(e,"touchcancel",this._onDrop),D(document,"selectstart",this)},_onDrop:function(e){var n=this.el,t=this.options;if(ie=ae(f),De=ae(f,t.draggable),ee("drop",this,{evt:e}),B=f&&f.parentNode,ie=ae(f),De=ae(f,t.draggable),v.eventCanceled){this._nulling();return}Be=!1,ot=!1,Qe=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Pt(this.cloneId),Pt(this._dragStartId),this.nativeDraggable&&(D(document,"drop",this),D(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Je&&b(document.body,"user-select",""),b(f,"transform",""),e&&(je&&(e.cancelable&&e.preventDefault(),!t.dropBubble&&e.stopPropagation()),y&&y.parentNode&&y.parentNode.removeChild(y),(A===B||W&&W.lastPutMode!=="clone")&&V&&V.parentNode&&V.parentNode.removeChild(V),f&&(this.nativeDraggable&&D(f,"dragend",this),Ot(f),f.style["will-change"]="",je&&!Be&&ne(f,W?W.options.ghostClass:this.options.ghostClass,!1),ne(f,this.options.chosenClass,!1),q({sortable:this,name:"unchoose",toEl:B,newIndex:null,newDraggableIndex:null,originalEvent:e}),A!==B?(ie>=0&&(q({rootEl:B,name:"add",toEl:B,fromEl:A,originalEvent:e}),q({sortable:this,name:"remove",toEl:B,originalEvent:e}),q({rootEl:B,name:"sort",toEl:B,fromEl:A,originalEvent:e}),q({sortable:this,name:"sort",toEl:B,originalEvent:e})),W&&W.save()):ie!==Ue&&ie>=0&&(q({sortable:this,name:"update",toEl:B,originalEvent:e}),q({sortable:this,name:"sort",toEl:B,originalEvent:e})),v.active&&((ie==null||ie===-1)&&(ie=Ue,De=qe),q({sortable:this,name:"end",toEl:B,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){ee("nulling",this),A=f=B=y=Ae=V=st=xe=Fe=de=je=ie=De=Ue=qe=Le=Ze=W=it=v.dragged=v.ghost=v.clone=v.active=null,ht.forEach(function(e){e.checked=!0}),ht.length=Ct=Tt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":f&&(this._onDragOver(e),$n(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,t=this.el.children,o=0,l=t.length,a=this.options;o<l;o++)n=t[o],ue(n,a.draggable,this.el,!1)&&e.push(n.getAttribute(a.dataIdAttr)||li(n));return e},sort:function(e,n){var t={},o=this.el;this.toArray().forEach(function(l,a){var r=o.children[a];ue(r,this.options.draggable,o,!1)&&(t[l]=r)},this),n&&this.captureAnimationState(),e.forEach(function(l){t[l]&&(o.removeChild(t[l]),o.appendChild(t[l]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return ue(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var t=this.options;if(n===void 0)return t[e];var o=et.modifyOption(this,e,n);typeof o<"u"?t[e]=o:t[e]=n,e==="group"&&vn(t)},destroy:function(){ee("destroy",this);var e=this.el;e[te]=null,D(e,"mousedown",this._onTapStart),D(e,"touchstart",this._onTapStart),D(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(D(e,"dragover",this),D(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),pt.splice(pt.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!xe){if(ee("hideClone",this),v.eventCanceled)return;b(V,"display","none"),this.options.removeCloneOnHide&&V.parentNode&&V.parentNode.removeChild(V),xe=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(xe){if(ee("showClone",this),v.eventCanceled)return;f.parentNode==A&&!this.options.group.revertClone?A.insertBefore(V,f):Ae?A.insertBefore(V,Ae):A.appendChild(V),this.options.group.revertClone&&this.animate(f,V),b(V,"display",""),xe=!1}}};function $n(i){i.dataTransfer&&(i.dataTransfer.dropEffect="move"),i.cancelable&&i.preventDefault()}function at(i,e,n,t,o,l,a,r){var s,d=i[te],p=d.options.onMove,m;return window.CustomEvent&&!ye&&!$e?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=e,s.from=i,s.dragged=n,s.draggedRect=t,s.related=o||e,s.relatedRect=l||Y(e),s.willInsertAfter=r,s.originalEvent=a,i.dispatchEvent(s),p&&(m=p.call(d,s,a)),m}function Ot(i){i.draggable=!1}function ei(){At=!1}function ti(i,e,n){var t=Y(Ye(n.el,0,n.options,!0)),o=pn(n.el,n.options,y),l=10;return e?i.clientX<o.left-l||i.clientY<t.top&&i.clientX<t.right:i.clientY<o.top-l||i.clientY<t.bottom&&i.clientX<t.left}function ni(i,e,n){var t=Y(Lt(n.el,n.options.draggable)),o=pn(n.el,n.options,y),l=10;return e?i.clientX>o.right+l||i.clientY>t.bottom&&i.clientX>t.left:i.clientY>o.bottom+l||i.clientX>t.right&&i.clientY>t.top}function ii(i,e,n,t,o,l,a,r){var s=t?i.clientY:i.clientX,d=t?n.height:n.width,p=t?n.top:n.left,m=t?n.bottom:n.right,_=!1;if(!a){if(r&&dt<d*o){if(!Qe&&(Ze===1?s>p+d*l/2:s<m-d*l/2)&&(Qe=!0),Qe)_=!0;else if(Ze===1?s<p+dt:s>m-dt)return-Ze}else if(s>p+d*(1-o)/2&&s<m-d*(1-o)/2)return oi(e)}return _=_||a,_&&(s<p+d*l/2||s>m-d*l/2)?s>p+d/2?1:-1:0}function oi(i){return ae(f)<ae(i)?1:-1}function li(i){for(var e=i.tagName+i.className+i.src+i.href+i.textContent,n=e.length,t=0;n--;)t+=e.charCodeAt(n);return t.toString(36)}function ai(i){ht.length=0;for(var e=i.getElementsByTagName("input"),n=e.length;n--;){var t=e[n];t.checked&&ht.push(t)}}function ut(i){return setTimeout(i,0)}function Pt(i){return clearTimeout(i)}vt&&x(document,"touchmove",function(i){(v.active||Be)&&i.cancelable&&i.preventDefault()});v.utils={on:x,off:D,css:b,find:un,is:function(e,n){return!!ue(e,n,e,!1)},extend:Yn,throttle:cn,closest:ue,toggleClass:ne,clone:mn,index:ae,nextTick:ut,cancelNextTick:Pt,detectDirection:gn,getChild:Ye,expando:te};v.get=function(i){return i[te]};v.mount=function(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(v.utils=me(me({},v.utils),t.utils)),et.mount(t)})};v.create=function(i,e){return new v(i,e)};v.version=Un;var X=[],We,Mt,Vt=!1,kt,Ft,gt,Ge;function ri(){function i(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return i.prototype={dragStarted:function(n){var t=n.originalEvent;this.sortable.nativeDraggable?x(document,"dragover",this._handleAutoScroll):this.options.supportPointer?x(document,"pointermove",this._handleFallbackAutoScroll):t.touches?x(document,"touchmove",this._handleFallbackAutoScroll):x(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var t=n.originalEvent;!this.options.dragOverBubble&&!t.rootEl&&this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?D(document,"dragover",this._handleAutoScroll):(D(document,"pointermove",this._handleFallbackAutoScroll),D(document,"touchmove",this._handleFallbackAutoScroll),D(document,"mousemove",this._handleFallbackAutoScroll)),an(),ct(),zn()},nulling:function(){gt=Mt=We=Vt=Ge=kt=Ft=null,X.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,t){var o=this,l=(n.touches?n.touches[0]:n).clientX,a=(n.touches?n.touches[0]:n).clientY,r=document.elementFromPoint(l,a);if(gt=n,t||this.options.forceAutoScrollFallback||$e||ye||Je){Nt(n,this.options,r,t);var s=Ce(r,!0);Vt&&(!Ge||l!==kt||a!==Ft)&&(Ge&&an(),Ge=setInterval(function(){var d=Ce(document.elementFromPoint(l,a),!0);d!==s&&(s=d,ct()),Nt(n,o.options,d,t)},10),kt=l,Ft=a)}else{if(!this.options.bubbleScroll||Ce(r,!0)===fe()){ct();return}Nt(n,this.options,Ce(r,!1),!1)}}},be(i,{pluginName:"scroll",initializeByDefault:!0})}function ct(){X.forEach(function(i){clearInterval(i.pid)}),X=[]}function an(){clearInterval(Ge)}var Nt=cn(function(i,e,n,t){if(e.scroll){var o=(i.touches?i.touches[0]:i).clientX,l=(i.touches?i.touches[0]:i).clientY,a=e.scrollSensitivity,r=e.scrollSpeed,s=fe(),d=!1,p;Mt!==n&&(Mt=n,ct(),We=e.scroll,p=e.scrollFn,We===!0&&(We=Ce(n,!0)));var m=0,_=We;do{var C=_,E=Y(C),w=E.top,I=E.bottom,G=E.left,P=E.right,M=E.width,k=E.height,u=void 0,F=void 0,H=C.scrollWidth,z=C.scrollHeight,K=b(C),pe=C.scrollLeft,oe=C.scrollTop;C===s?(u=M<H&&(K.overflowX==="auto"||K.overflowX==="scroll"||K.overflowX==="visible"),F=k<z&&(K.overflowY==="auto"||K.overflowY==="scroll"||K.overflowY==="visible")):(u=M<H&&(K.overflowX==="auto"||K.overflowX==="scroll"),F=k<z&&(K.overflowY==="auto"||K.overflowY==="scroll"));var _e=u&&(Math.abs(P-o)<=a&&pe+M<H)-(Math.abs(G-o)<=a&&!!pe),le=F&&(Math.abs(I-l)<=a&&oe+k<z)-(Math.abs(w-l)<=a&&!!oe);if(!X[m])for(var he=0;he<=m;he++)X[he]||(X[he]={});(X[m].vx!=_e||X[m].vy!=le||X[m].el!==C)&&(X[m].el=C,X[m].vx=_e,X[m].vy=le,clearInterval(X[m].pid),(_e!=0||le!=0)&&(d=!0,X[m].pid=setInterval((function(){t&&this.layer===0&&v.active._onTouchMove(gt);var we=X[this.layer].vy?X[this.layer].vy*r:0,ce=X[this.layer].vx?X[this.layer].vx*r:0;typeof p=="function"&&p.call(v.dragged.parentNode[te],ce,we,i,gt,X[this.layer].el)!=="continue"||fn(X[this.layer].el,ce,we)}).bind({layer:m}),24))),m++}while(e.bubbleScroll&&_!==s&&(_=Ce(_,!1)));Vt=d}},30),_n=function(e){var n=e.originalEvent,t=e.putSortable,o=e.dragEl,l=e.activeSortable,a=e.dispatchSortableEvent,r=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(n){var d=t||l;r();var p=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,m=document.elementFromPoint(p.clientX,p.clientY);s(),d&&!d.el.contains(m)&&(a("spill"),this.onSpill({dragEl:o,putSortable:t}))}};function Bt(){}Bt.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,t=e.putSortable;this.sortable.captureAnimationState(),t&&t.captureAnimationState();var o=Ye(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(n,o):this.sortable.el.appendChild(n),this.sortable.animateAll(),t&&t.animateAll()},drop:_n};be(Bt,{pluginName:"revertOnSpill"});function Ut(){}Ut.prototype={onSpill:function(e){var n=e.dragEl,t=e.putSortable,o=t||this.sortable;o.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),o.animateAll()},drop:_n};be(Ut,{pluginName:"removeOnSpill"});v.mount(new ri);v.mount(Ut,Bt);const si={__name:"IntegramUpload",setup(i,{expose:e}){e();const n=jt(),{isAuthenticated:t}=Jt(),o=Wt(),{setTimeout:l}=qt(),a=He(()=>[{label:"Загрузка",icon:"pi pi-upload",to:void 0}]),r=R(null),s=R(""),d=R(null),p=R(""),m=R(!1),_=R(!1),C=R(!1),E=R(!1),w=R([]),I=R([]),G=R(null),P=R(""),M=R({}),k=R(null),u=R(""),F=R({}),H=R({}),z=R({hasHeader:!0,trim:!0,delimiter:"",lineDelimiter:"",batchSize:1e3,encoding:"utf-8"}),K=[{label:"UTF-8 (Recommended)",value:"utf-8"},{label:"Windows-1251 (Cyrillic)",value:"windows-1251"},{label:"ISO-8859-1 (Latin-1)",value:"iso-8859-1"},{label:"Windows-1252 (Western European)",value:"windows-1252"},{label:"KOI8-R (Russian)",value:"koi8-r"},{label:"GB2312 (Simplified Chinese)",value:"gb2312"},{label:"Shift-JIS (Japanese)",value:"shift-jis"}],pe=R([{label:"*** Создать новую таблицу из файла ***",value:"new"}]),oe=R(!1),_e=R([]);async function le(){try{oe.value=!0;const h=await Kt.getDictionary();if(pe.value=[{label:"*** Создать новую таблицу из файла ***",value:"new"}],h&&typeof h=="object"){const g=Object.entries(h).map(([O,T])=>({label:T,value:O})).sort((O,T)=>O.label.localeCompare(T.label));pe.value.push(...g)}}catch(h){console.error("Failed to load types:",h),o.add({severity:"error",summary:"Ошибка",detail:"Не удалось загрузить список таблиц: "+(h.message||"Ошибка API"),life:5e3})}finally{oe.value=!1}}const he=He(()=>I.value.filter(h=>!H.value[h.field])),we=He(()=>I.value.map(h=>{const g=Te(h.field);return{field:h.field,header:h.header,skipped:H.value[h.field]||!1,...g}})),ce=He(()=>{let h=0,g=0;return we.value.forEach(O=>{O.skipped||(h+=O.empty||0,g+=O.invalid||0)}),{empty:h,invalid:g}});function Te(h){if(!w.value||w.value.length===0)return{empty:0,invalid:0,min:"",max:"",sum:0,avg:0,isNumeric:!1};let g=0,O=0,T=null,N=null,Z=0,Ie=0,re=!0;const ze=w.value.map(Se=>Se[h]).filter(Se=>Se!=null&&Se!=="").slice(0,10);ze.length>0?re=ze.filter(Pe=>{const Oe=parseFloat(String(Pe).replace(",",".").replace(/\s/g,""));return!isNaN(Oe)}).length>=ze.length*.8:re=!1,w.value.forEach(Se=>{const Pe=Se[h];if(Pe==null||Pe===""){g++;return}const Oe=String(Pe).trim();if(re){const Me=parseFloat(Oe.replace(",",".").replace(/\s/g,""));isNaN(Me)?O++:(Z+=Me,Ie++,(T===null||Me<T)&&(T=Me),(N===null||Me>N)&&(N=Me))}else(T===null||Oe<T)&&(T=Oe),(N===null||Oe>N)&&(N=Oe),Ie++});const Nn=re&&Ie>0?Math.round(Z/Ie*100)/100:0;return re?(Z=Math.round(Z*100)/100,T=T!==null?Math.round(T*100)/100:"",N=N!==null?Math.round(N*100)/100:""):(T&&T.length>20&&(T=T.substring(0,20)+"..."),N&&N.length>20&&(N=N.substring(0,20)+"...")),{empty:g,invalid:O,min:T||"",max:N||"",sum:Z,avg:Nn,isNumeric:re}}function ge(){const h=localStorage.getItem("integram_import_settings");if(h)try{const g=JSON.parse(h);_e.value=Object.keys(g).map(O=>({label:O,value:O}))}catch(g){console.error("Failed to load saved settings:",g)}}function bt(){r.value==="new"?s.value="Новая таблица / New table":yt()}function yt(){s.value="Загруженный тип"}function tt(h){const g=h.files[0],O=new FileReader;O.onload=T=>{p.value=T.target.result,nt()},O.readAsText(g,z.value.encoding)}function nt(){if(!p.value){o.add({severity:"warn",summary:"Предупреждение",detail:"Файл пуст",life:3e3});return}try{const h=p.value.split(`
`).filter(N=>N.trim()),g=z.value.delimiter||Xt(h[0]),O=z.value.hasHeader?h[0].split(g).map(N=>N.trim()):h[0].split(g).map((N,Z)=>`Column${Z+1}`),T=z.value.hasHeader?h.slice(1):h;I.value=O.map((N,Z)=>({field:`col${Z}`,header:N})),w.value=T.slice(0,100).map(N=>{const Z=N.split(g).map(re=>z.value.trim?re.trim():re),Ie={};return Z.forEach((re,ze)=>{Ie[`col${ze}`]=re}),Ie}),o.add({severity:"success",summary:"Успешно",detail:`Обработано ${w.value.length} строк`,life:3e3})}catch(h){o.add({severity:"error",summary:"Ошибка",detail:`Ошибка парсинга: ${h.message}`,life:5e3})}}function Xt(h){const g=[",","	",";","|"];let O=0,T=",";return g.forEach(N=>{const Z=(h.match(new RegExp("\\"+N,"g"))||[]).length;Z>O&&(O=Z,T=N)}),T}function wn(){E.value=!1,o.add({severity:"info",summary:"Загрузка",detail:"Функционал загрузки будет реализован через API",life:5e3})}function Sn(){r.value=null,s.value="",p.value="",w.value=[],I.value=[],m.value=!1,_.value=!1,C.value=!1,M.value={},F.value={},H.value={},k.value=null,u.value=""}function En(h){k.value=h.field,u.value=M.value[h.field]||"",C.value=!0}function Dn(){k.value&&(u.value.trim()?(M.value[k.value]=u.value.trim(),o.add({severity:"success",summary:"Формула сохранена",detail:"Формула для поля сохранена",life:2e3})):delete M.value[k.value])}function xn(){k.value&&M.value[k.value]&&(delete M.value[k.value],u.value="",o.add({severity:"info",summary:"Формула удалена",detail:"Формула для поля удалена",life:2e3}))}function Cn(h){u.value+=`[${h}]`}function Tn(h){const g=F.value[h]||0;F.value[h]=(g+1)%3;const O=F.value[h],T={0:"Поле не связано со справочником",1:"Поле связано со справочником",2:"Поле связано со справочником (множественный выбор)"};o.add({severity:O===0?"secondary":"success",summary:T[O],life:2e3})}function In(h){const g=F.value[h]||0;return g===2?"pi pi-list":"pi pi-link"}function On(h){const g=F.value[h]||0;return g===2?"success":g===1?"info":"secondary"}function kn(h){const g=F.value[h]||0;return g===2?"Множественный выбор из справочника (нажмите для отключения)":g===1?"Связь со справочником (нажмите для множественного выбора)":"Нажмите для связи со справочником"}function Fn(){if(!P.value){o.add({severity:"warn",summary:"Предупреждение",detail:"Укажите название настройки / Please provide a setting name",life:3e3});return}try{const h=JSON.parse(localStorage.getItem("integram_import_settings")||"{}");h[P.value]={...z.value,fieldOrder:I.value.map((g,O)=>({...g,order:O})),formulas:{...M.value},links:{...F.value},skipped:{...H.value}},localStorage.setItem("integram_import_settings",JSON.stringify(h)),ge(),o.add({severity:"success",summary:"Сохранено / Saved",detail:`Настройка "${P.value}" сохранена`,life:3e3}),P.value=""}catch(h){o.add({severity:"error",summary:"Ошибка",detail:`Не удалось сохранить: ${h.message}`,life:5e3})}}function Yt(){if(d.value)try{const g=JSON.parse(localStorage.getItem("integram_import_settings")||"{}")[d.value];g&&(z.value={hasHeader:g.hasHeader,trim:g.trim,delimiter:g.delimiter,lineDelimiter:g.lineDelimiter,batchSize:g.batchSize,encoding:g.encoding||"utf-8"},g.formulas&&(M.value={...g.formulas}),g.links&&(F.value={...g.links}),g.skipped&&(H.value={...g.skipped}),o.add({severity:"success",summary:"Загружено / Loaded",detail:`Настройка "${d.value}" применена`,life:3e3}))}catch(h){o.add({severity:"error",summary:"Ошибка",detail:`Не удалось загрузить: ${h.message}`,life:5e3})}}function zt(){G.value&&v.create(G.value,{animation:150,handle:".drag-handle",ghostClass:"sortable-ghost",onEnd:h=>{const g=h.oldIndex,O=h.newIndex,T=I.value.splice(g,1)[0];I.value.splice(O,0,T),o.add({severity:"info",summary:"Поле перемещено",detail:`"${T.header}" перемещено на позицию ${O+1}`,life:2e3})}})}Gt(async()=>{if(!t.value){n.push("/integram/login?redirect="+encodeURIComponent(window.location.pathname));return}await le(),ge()}),_t(w,()=>{w.value.length>0&&l(()=>{zt()},100)}),_t(d,()=>{d.value&&Yt()});const Ht={router:n,isAuthenticated:t,toast:o,setTimerTimeout:l,breadcrumbItems:a,selectedType:r,selectedTypeName:s,selectedSetting:d,fileContent:p,showSettings:m,showStats:_,showFormulaEditor:C,confirmUpload:E,preview:w,previewColumns:I,fieldMappingList:G,settingName:P,columnFormulas:M,selectedFormulaField:k,currentFormula:u,columnLinks:F,columnSkipped:H,settings:z,encodingOptions:K,typeOptions:pe,typesLoading:oe,settingsOptions:_e,loadTypes:le,activeColumns:he,columnStatsArray:we,totalStats:ce,calculateColumnStats:Te,loadSavedSettings:ge,onTypeSelected:bt,loadTypeDetails:yt,onFileSelect:tt,validateFile:nt,detectDelimiter:Xt,doUpload:wn,resetSelection:Sn,selectFieldForFormula:En,saveFormula:Dn,clearFormula:xn,insertFieldInFormula:Cn,toggleLink:Tn,getLinkIcon:In,getLinkSeverity:On,getLinkTooltip:kn,saveImportSettings:Fn,loadImportSettings:Yt,initFieldReordering:zt,IntegramBreadcrumb:An,ref:R,computed:He,onMounted:Gt,watch:_t,get useRouter(){return jt},get useToast(){return Wt},get useIntegramSession(){return Jt},get integramApiClient(){return Kt},get Sortable(){return v},get useTimer(){return qt}};return Object.defineProperty(Ht,"__isScriptSetup",{enumerable:!1,value:!0}),Ht}},di={class:"integram-upload-page integram-touch-friendly"},ui={key:0,class:"mb-4"},ci={class:"field"},fi={class:"field"},mi={key:1,class:"upload-area"},pi={class:"mb-3"},hi={class:"integram-actions"},gi={class:"grid"},vi={class:"col-12 md:col-6"},bi={class:"field-checkbox mb-3"},yi={class:"field-checkbox"},_i={class:"col-12 md:col-6"},wi={class:"field mb-3"},Si={class:"field mb-3"},Ei={class:"field mb-3"},Di={class:"field"},xi={class:"mt-3"},Ci={class:"flex gap-2 align-items-center"},Ti={ref:"fieldMappingList",class:"field-mapping-list"},Ii=["data-index"],Oi={class:"flex align-items-center gap-3 p-3 surface-50 border-round"},ki=["onClick"],Fi={class:"text-sm text-500"},Ni={key:0,class:"text-xs text-green-500 mt-1"},Ai={class:"text-sm text-500"},Pi={class:"flex align-items-center gap-2"},Mi={class:"formula-editor"},Vi={class:"flex gap-2 align-items-center mb-3"},Ri={class:"formula-help surface-ground p-3 border-round"},Li={class:"mt-2"},Bi={class:"flex flex-wrap gap-1 mt-1"},Ui={key:4,class:"integram-actions"},Xi={class:"grid mb-4"},Yi={class:"col-6 md:col-3"},zi={class:"text-center p-3 surface-ground border-round"},Hi={class:"text-2xl font-bold text-primary"},ji={class:"col-6 md:col-3"},Wi={class:"text-center p-3 surface-ground border-round"},Gi={class:"text-2xl font-bold text-primary"},Ji={class:"col-6 md:col-3"},Ki={class:"text-center p-3 surface-ground border-round"},qi={class:"col-6 md:col-3"},Zi={class:"text-center p-3 surface-ground border-round"},Qi={class:"text-2xl font-bold text-500"},$i={key:0,class:"ml-2 text-xs text-orange-500"},eo={class:"text-sm"},to={class:"text-sm"},no={key:0},io={key:1,class:"text-400"},oo={key:0},lo={key:1,class:"text-400"},ao={class:"integram-actions justify-content-end w-full"};function ro(i,e,n,t,o,l){const a=Q("Select"),r=Q("Button"),s=Q("Textarea"),d=Q("FileUpload"),p=Q("Panel"),m=Q("Checkbox"),_=Q("InputText"),C=Q("InputNumber"),E=Q("Divider"),w=Q("Badge"),I=Q("Column"),G=Q("DataTable"),P=Q("Card"),M=Q("Dialog"),k=Mn("tooltip");return L(),$("div",di,[S(t.IntegramBreadcrumb,{items:t.breadcrumbItems},null,8,["items"]),S(P,null,{title:U(()=>[...e[18]||(e[18]=[c("div",{class:"flex align-items-center justify-content-between"},[c("span",null,"Загрузка файлов")],-1)])]),content:U(()=>[t.selectedType?se("",!0):(L(),$("div",ui,[c("div",ci,[e[19]||(e[19]=c("label",{for:"typeSelect"},"Выберите таблицу для загрузки",-1)),S(a,{id:"typeSelect",modelValue:t.selectedType,"onUpdate:modelValue":e[0]||(e[0]=u=>t.selectedType=u),options:t.typeOptions,optionLabel:"label",optionValue:"value",placeholder:"Выберите таблицу",class:"w-full",onChange:t.onTypeSelected},null,8,["modelValue","options"])]),c("div",fi,[e[20]||(e[20]=c("label",{for:"settingsSelect"},"или выберите сохраненную настройку",-1)),S(a,{id:"settingsSelect",modelValue:t.selectedSetting,"onUpdate:modelValue":e[1]||(e[1]=u=>t.selectedSetting=u),options:t.settingsOptions,optionLabel:"label",optionValue:"value",placeholder:"Настройки импорта",class:"w-full"},null,8,["modelValue","options"])])])),t.selectedType?(L(),$("div",mi,[c("div",pi,[S(r,{icon:"pi pi-arrow-left",label:"Вернуться к выбору таблицы",onClick:t.resetSelection,text:"","aria-label":"Вернуться к выбору таблицы"}),c("h4",null,j(t.selectedTypeName),1)]),S(p,{header:"Загрузка данных",class:"mb-3"},{default:U(()=>[e[21]||(e[21]=c("p",{class:"mb-2"},[ke(" Вставьте текст из файла в это поле или выберите файл для загрузки:"),c("br"),c("small",null,"JSON или любой текстовый файл: CSV, TXT и т.п. Форматы XLS и XLSX пока не поддерживаются")],-1)),S(s,{modelValue:t.fileContent,"onUpdate:modelValue":e[2]||(e[2]=u=>t.fileContent=u),rows:5,class:"w-full mb-2",placeholder:"Вставьте содержимое файла..."},null,8,["modelValue"]),S(d,{mode:"basic",accept:".txt,.csv,.json",maxFileSize:1e7,onSelect:t.onFileSelect,chooseLabel:"Выберите файл",class:"mb-2"}),c("div",hi,[S(r,{label:"Проверить",icon:"pi pi-check",onClick:t.validateFile,disabled:!t.fileContent,"aria-label":"Проверить файл"},null,8,["disabled"]),S(r,{label:"Настроить",icon:"pi pi-cog",onClick:e[3]||(e[3]=u=>t.showSettings=!t.showSettings),outlined:"","aria-label":"Настройки импорта"})])]),_:1}),t.showSettings?(L(),Ee(p,{key:0,header:"Настройки импорта",class:"mb-3"},{default:U(()=>[c("div",gi,[c("div",vi,[c("div",bi,[S(m,{modelValue:t.settings.hasHeader,"onUpdate:modelValue":e[4]||(e[4]=u=>t.settings.hasHeader=u),inputId:"hasHeader",binary:!0},null,8,["modelValue"]),e[22]||(e[22]=c("label",{for:"hasHeader"},"Первая строка содержит заголовок",-1))]),c("div",yi,[S(m,{modelValue:t.settings.trim,"onUpdate:modelValue":e[5]||(e[5]=u=>t.settings.trim=u),inputId:"trim",binary:!0},null,8,["modelValue"]),e[23]||(e[23]=c("label",{for:"trim"},"Обрезать пробелы справа и слева",-1))])]),c("div",_i,[c("div",wi,[e[25]||(e[25]=c("label",{for:"delimiter"},"Разделитель полей",-1)),S(_,{id:"delimiter",modelValue:t.settings.delimiter,"onUpdate:modelValue":e[6]||(e[6]=u=>t.settings.delimiter=u),placeholder:"auto",class:"w-full"},null,8,["modelValue"]),c("small",null,[S(r,{text:"",onClick:e[7]||(e[7]=u=>t.settings.delimiter="	")},{default:U(()=>[...e[24]||(e[24]=[ke("TAB",-1)])]),_:1})])]),c("div",Si,[e[26]||(e[26]=c("label",{for:"lineDelimiter"},"Разделитель строк",-1)),S(_,{id:"lineDelimiter",modelValue:t.settings.lineDelimiter,"onUpdate:modelValue":e[8]||(e[8]=u=>t.settings.lineDelimiter=u),placeholder:"auto",class:"w-full"},null,8,["modelValue"])]),c("div",Ei,[e[27]||(e[27]=c("label",{for:"batchSize"},"Строк в батче",-1)),S(C,{id:"batchSize",modelValue:t.settings.batchSize,"onUpdate:modelValue":e[9]||(e[9]=u=>t.settings.batchSize=u),min:1,max:1e4,class:"w-full"},null,8,["modelValue"])]),c("div",Di,[e[28]||(e[28]=c("label",{for:"encoding"},"Кодировка файла",-1)),S(a,{id:"encoding",modelValue:t.settings.encoding,"onUpdate:modelValue":e[10]||(e[10]=u=>t.settings.encoding=u),options:t.encodingOptions,optionLabel:"label",optionValue:"value",placeholder:"Select encoding",class:"w-full"},null,8,["modelValue"]),e[29]||(e[29]=c("small",{class:"text-500"},"UTF-8 рекомендуется для большинства файлов",-1))])])]),c("div",xi,[S(E),c("div",Ci,[S(r,{label:"Сохранить настройки",icon:"pi pi-save",size:"small",outlined:"",onClick:t.saveImportSettings}),S(_,{modelValue:t.settingName,"onUpdate:modelValue":e[11]||(e[11]=u=>t.settingName=u),placeholder:"Название настройки",class:"flex-1",size:"small"},null,8,["modelValue"])])])]),_:1})):se("",!0),t.preview.length>0?(L(),Ee(p,{key:1,header:"Порядок и сопоставление полей",class:"mb-3"},{default:U(()=>[e[32]||(e[32]=c("p",{class:"mb-3 text-sm text-500"}," Перетащите поля для изменения порядка. Нажмите на иконку ссылки для связи со справочником. ",-1)),c("div",Ti,[(L(!0),$(wt,null,St(t.previewColumns,(u,F)=>{var H;return L(),$("div",{key:u.field,class:Ve(["field-mapping-item",{"has-formula":t.columnFormulas[u.field],"is-skipped":t.columnSkipped[u.field]}]),"data-index":F},[c("div",Oi,[e[31]||(e[31]=c("i",{class:"pi pi-bars drag-handle cursor-move text-500"},null,-1)),Et(S(m,{modelValue:t.columnSkipped[u.field],"onUpdate:modelValue":z=>t.columnSkipped[u.field]=z,inputId:`skip_${u.field}`,binary:!0},null,8,["modelValue","onUpdate:modelValue","inputId"]),[[k,t.columnSkipped[u.field]?"Колонка пропущена":"Пропустить колонку",void 0,{top:!0}]]),Et(S(r,{icon:t.getLinkIcon(u.field),severity:t.getLinkSeverity(u.field),text:"",rounded:"",size:"small",onClick:z=>t.toggleLink(u.field),disabled:t.columnSkipped[u.field]},null,8,["icon","severity","onClick","disabled"]),[[k,t.getLinkTooltip(u.field),void 0,{top:!0}]]),c("div",{class:"flex-1",onClick:z=>t.selectFieldForFormula(u)},[c("strong",{class:Ve({"text-primary":t.selectedFormulaField===u.field})},j(u.header),3),c("div",Fi," Пример: "+j(((H=t.preview[0])==null?void 0:H[u.field])||"N/A"),1),t.columnFormulas[u.field]?(L(),$("div",Ni,[e[30]||(e[30]=c("i",{class:"pi pi-calculator"},null,-1)),ke(" "+j(t.columnFormulas[u.field]),1)])):se("",!0)],8,ki),c("div",Ai,"Позиция: "+j(F+1),1)])],10,Ii)}),128))],512)]),_:1})):se("",!0),t.preview.length>0?(L(),Ee(p,{key:2,header:"Формулы для вычисления полей",toggleable:!0,collapsed:!t.showFormulaEditor},{header:U(()=>[c("div",Pi,[e[33]||(e[33]=c("i",{class:"pi pi-calculator"},null,-1)),e[34]||(e[34]=c("span",null,"Формулы для вычисления полей",-1)),Object.keys(t.columnFormulas).length>0?(L(),Ee(w,{key:0,value:Object.keys(t.columnFormulas).length,severity:"success"},null,8,["value"])):se("",!0)])]),default:U(()=>[c("div",Mi,[c("div",Vi,[S(a,{modelValue:t.selectedFormulaField,"onUpdate:modelValue":e[12]||(e[12]=u=>t.selectedFormulaField=u),options:t.previewColumns,optionLabel:"header",optionValue:"field",placeholder:"Выберите поле",class:"w-auto",style:{"min-width":"200px"}},null,8,["modelValue","options"]),S(_,{modelValue:t.currentFormula,"onUpdate:modelValue":e[13]||(e[13]=u=>t.currentFormula=u),placeholder:"Формула: [Поле1] * [Поле2]",class:"flex-1",onKeyup:Vn(t.saveFormula,["enter"])},null,8,["modelValue"]),S(r,{label:"Сохранить",icon:"pi pi-check",size:"small",onClick:t.saveFormula,disabled:!t.selectedFormulaField},null,8,["disabled"]),Et(S(r,{icon:"pi pi-trash",severity:"danger",text:"",size:"small",onClick:t.clearFormula,disabled:!t.selectedFormulaField||!t.columnFormulas[t.selectedFormulaField]},null,8,["disabled"]),[[k,"Удалить формулу",void 0,{top:!0}]])]),c("div",Ri,[e[36]||(e[36]=c("p",{class:"m-0 mb-2 font-semibold"},"Синтаксис формул:",-1)),e[37]||(e[37]=c("ul",{class:"m-0 pl-4 text-sm"},[c("li",null,[ke("Используйте "),c("code",null,"[Название поля]"),ke(" для ссылки на другие поля")]),c("li",null,[ke("Пример: "),c("code",null,"[Цена] * [Количество]")]),c("li",null,[ke("Пример: "),c("code",null,"IF([Статус]='Активен', 1, 0)")]),c("li",null,"Доступные функции: IF, CONCAT, UPPER, LOWER, TRIM, ROUND")],-1)),c("div",Li,[e[35]||(e[35]=c("span",{class:"text-sm text-500"},"Быстрая вставка поля:",-1)),c("div",Bi,[(L(!0),$(wt,null,St(t.previewColumns,u=>(L(),Ee(r,{key:u.field,label:u.header,size:"small",text:"",onClick:F=>t.insertFieldInFormula(u.header)},null,8,["label","onClick"]))),128))])])])])]),_:1},8,["collapsed"])):se("",!0),t.preview.length>0?(L(),Ee(p,{key:3,header:"Предварительный просмотр",class:"mb-3"},{default:U(()=>[S(G,{value:t.preview,rows:5,paginator:""},{default:U(()=>[(L(!0),$(wt,null,St(t.previewColumns,(u,F)=>(L(),Ee(I,{key:F,field:u.field,header:u.header},null,8,["field","header"]))),128))]),_:1},8,["value"])]),_:1})):se("",!0),t.preview.length>0?(L(),$("div",Ui,[S(r,{label:"Загрузить",icon:"pi pi-upload",onClick:e[14]||(e[14]=u=>t.confirmUpload=!0),severity:"warning","aria-label":"Загрузить данные"}),S(r,{label:"Статистика",icon:"pi pi-chart-bar",onClick:e[15]||(e[15]=u=>t.showStats=!t.showStats),outlined:"","aria-label":"Показать статистику"})])):se("",!0),t.showStats?(L(),Ee(p,{key:5,header:"Статистика импорта",class:"mt-3"},{default:U(()=>[c("div",Xi,[c("div",Yi,[c("div",zi,[c("div",Hi,j(t.preview.length),1),e[38]||(e[38]=c("div",{class:"text-sm text-500"},"Строк",-1))])]),c("div",ji,[c("div",Wi,[c("div",Gi,j(t.activeColumns.length),1),e[39]||(e[39]=c("div",{class:"text-sm text-500"},"Колонок (активных)",-1))])]),c("div",Ji,[c("div",Ki,[c("div",{class:Ve(["text-2xl font-bold",t.totalStats.invalid>0?"text-orange-500":"text-green-500"])},j(t.totalStats.invalid),3),e[40]||(e[40]=c("div",{class:"text-sm text-500"},"Ошибок",-1))])]),c("div",qi,[c("div",Zi,[c("div",Qi,j(t.totalStats.empty),1),e[41]||(e[41]=c("div",{class:"text-sm text-500"},"Пустых ячеек",-1))])])]),S(G,{value:t.columnStatsArray,size:"small",stripedRows:"",showGridlines:"",class:"text-sm"},{default:U(()=>[S(I,{field:"header",header:"Колонка",style:{"min-width":"150px"}},{body:U(({data:u})=>[c("span",{class:Ve({"line-through text-400":u.skipped})},j(u.header),3),u.skipped?(L(),$("span",$i,"(пропущена)")):se("",!0)]),_:1}),S(I,{field:"empty",header:"Пусто",style:{width:"80px","text-align":"right"}},{body:U(({data:u})=>[c("span",{class:Ve({"text-400":u.empty===0})},j(u.empty||"-"),3)]),_:1}),S(I,{field:"invalid",header:"Ошибки",style:{width:"80px","text-align":"right"}},{body:U(({data:u})=>[c("span",{class:Ve({"text-orange-500 font-bold":u.invalid>0})},j(u.invalid||"-"),3)]),_:1}),S(I,{field:"min",header:"Мин",style:{"min-width":"100px"}},{body:U(({data:u})=>[c("span",eo,j(u.min||"-"),1)]),_:1}),S(I,{field:"max",header:"Макс",style:{"min-width":"100px"}},{body:U(({data:u})=>[c("span",to,j(u.max||"-"),1)]),_:1}),S(I,{field:"sum",header:"Сумма",style:{width:"100px","text-align":"right"}},{body:U(({data:u})=>[u.isNumeric?(L(),$("span",no,j(u.sum),1)):(L(),$("span",io,"-"))]),_:1}),S(I,{field:"avg",header:"Среднее",style:{width:"100px","text-align":"right"}},{body:U(({data:u})=>[u.isNumeric?(L(),$("span",oo,j(u.avg),1)):(L(),$("span",lo,"-"))]),_:1})]),_:1},8,["value"])]),_:1})):se("",!0)])):se("",!0)]),_:1}),S(M,{visible:t.confirmUpload,"onUpdate:visible":e[17]||(e[17]=u=>t.confirmUpload=u),header:"Подтверждение загрузки",modal:!0,style:{width:"400px"}},{footer:U(()=>[c("div",ao,[S(r,{label:"Отменить",icon:"pi pi-times",onClick:e[16]||(e[16]=u=>t.confirmUpload=!1),text:"","aria-label":"Отменить загрузку"}),S(r,{label:"Да, загружаем",icon:"pi pi-upload",onClick:t.doUpload,severity:"warning","aria-label":"Подтвердить загрузку"})])]),default:U(()=>[c("p",null,"Вы уверены, что хотите загрузить "+j(t.preview.length)+" записей?",1)]),_:1},8,["visible"])])}const go=Pn(si,[["render",ro],["__scopeId","data-v-6084a4b0"],["__file","/home/hive/integram-standalone/src/components/integram/IntegramUpload.vue"]]);export{go as default};
