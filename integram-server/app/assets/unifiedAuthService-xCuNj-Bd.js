import{a as n}from"./index-B9ygI19o.js";function u(){const e=localStorage.getItem("unified_auth_session_id"),t=localStorage.getItem("integram_session");return!!(e||t)}async function r(){const e=localStorage.getItem("integram_session");if(!e)return null;try{return JSON.parse(e)}catch(t){return console.warn("[unifiedAuthService] Failed to parse session data:",t),null}}async function l(e){const t=await r();if(!t)return null;if(t.database===e||t.authDatabase===e)return{token:t.token,xsrf:t.xsrfToken,userId:t.userId,userName:t.userName,database:t.database};const a=localStorage.getItem(`${e}_token`),s=localStorage.getItem(`${e}_xsrf`),o=localStorage.getItem(`${e}_id`),c=localStorage.getItem(`${e}_user`);return a?{token:a,xsrf:s,userId:o,userName:c,database:e}:null}async function i(){const e={},t=await r();if(t){const s=t.database||t.authDatabase;e[s]={token:t.token,xsrf:t.xsrfToken,userId:t.userId,userName:t.userName,database:s}}const a=["ddadmin","my","a2025"];for(const s of a){const o=localStorage.getItem(`${s}_token`);o&&!e[s]&&(e[s]={token:o,xsrf:localStorage.getItem(`${s}_xsrf`),userId:localStorage.getItem(`${s}_id`),userName:localStorage.getItem(`${s}_user`),database:s})}return e}async function g(){const e=await i();return Object.keys(e)}async function f(){localStorage.removeItem("unified_auth_session_id"),localStorage.removeItem("integram_session");try{await n.post("/api/auth/logout")}catch(e){console.warn("[unifiedAuthService] Logout API call failed:",e.message)}}async function d(e){return(await n.post("/api/auth/login",e)).data}async function m(e){return(await n.post("/api/auth/verify",{token:e})).data}const S={isAuthenticated:u,getSession:r,getTokenForDatabase:l,getAllTokens:i,getAvailableDatabases:g,logout:f,login:d,verifyToken:m};export{S as u};
