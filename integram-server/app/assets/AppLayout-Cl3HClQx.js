const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AppConfigurator-DhaJZLJw.js","assets/index-B4X-KBPT.js","assets/index-qS_NbCi9.css","assets/logger-CLWPjr6Q.js","assets/authStore-CrLeEHn0.js","assets/index-B9ygI19o.js","assets/unifiedAuthService-xCuNj-Bd.js","assets/integramApiClient-C3_j8SPw.js","assets/useTimer-rFA0hy1q.js","assets/SafeRouterView-PpaTeXkn.js","assets/AppConfigurator-DqygoZK7.css","assets/Profile-B2LB9zTX.js","assets/Profile-xwTLVogu.css","assets/NotificationCenter-D27q8ZhZ.js","assets/NotificationCenter-CuozfZwU.css","assets/AgentStatusPanel-CjZ-cNgd.js","assets/AgentStatusPanel-Dkd32PzP.css","assets/Chat-CyOu8B_c.js","assets/Chat-CSswv2-k.css","assets/ReleaseNotesModal-jiap4HDD.js"])))=>i.map(i=>d[i]);
import{I as L,E as lt,_ as ae,y as te,c as _,a as i,b as A,f as ce,t as Z,g as U,A as T,w as F,d as w,J as se,O as ge,o as c,u as Oe,j as be,h as G,P as ke,C as ct,F as me,r as Le,v as Ne,T as it,K as we,L as Ke,S as Ve,U as W,D as Ue,n as rt,e as st,k as Be,V as Pe,W as dt,X as mt,Y as de,Z as gt,$ as ft,a0 as Se,a1 as je}from"./index-B4X-KBPT.js";import{l as x}from"./logger-CLWPjr6Q.js";import{u as Fe,a as pt}from"./authStore-CrLeEHn0.js";import{i as De}from"./integramApiClient-C3_j8SPw.js";import{u as We}from"./useTimer-rFA0hy1q.js";import{S as vt}from"./SafeRouterView-PpaTeXkn.js";const ht=()=>{if(typeof window>"u")return!1;const m=localStorage.getItem("darkTheme");return m?JSON.parse(m):!1},re=lt({preset:"Aura",primary:"cyan",surface:"neutral",darkTheme:ht(),menuMode:"static"}),yt=()=>{if(typeof window>"u")return!0;const m=localStorage.getItem("sidebarCollapsed");return m?JSON.parse(m):!0},ee=lt({staticMenuDesktopInactive:!1,overlayMenuActive:!1,profileSidebarVisible:!1,configSidebarVisible:!1,staticMenuMobileActive:!1,menuHoverActive:!1,activeMenuItem:null,sidebarCollapsed:yt()});typeof window<"u"&&document.documentElement.classList.toggle("app-dark",re.darkTheme);function fe(){const m=M=>{if(M==null){ee.activeMenuItem=null;return}ee.activeMenuItem=M&&typeof M=="object"&&"value"in M?M.value:M},n=()=>{if(!document.startViewTransition){t();return}document.startViewTransition(()=>t(event))},t=()=>{re.darkTheme=!re.darkTheme,typeof window<"u"&&(localStorage.setItem("darkTheme",JSON.stringify(re.darkTheme)),document.documentElement.classList.toggle("app-dark",re.darkTheme))},e=()=>{re.menuMode==="overlay"&&(ee.overlayMenuActive=!ee.overlayMenuActive),window.innerWidth>991?ee.staticMenuDesktopInactive=!ee.staticMenuDesktopInactive:ee.staticMenuMobileActive=!ee.staticMenuMobileActive},I=()=>{if(ee.sidebarCollapsed=!ee.sidebarCollapsed,typeof window<"u"){const M=ee.sidebarCollapsed;queueMicrotask(()=>{localStorage.setItem("sidebarCollapsed",JSON.stringify(M))})}},k=L(()=>ee.overlayMenuActive||ee.staticMenuMobileActive),y=L(()=>re.darkTheme),r=L(()=>re.primary),g=L(()=>re.surface);return{layoutConfig:re,layoutState:ee,toggleMenu:e,toggleSidebarCollapse:I,isSidebarActive:k,isDarkTheme:y,getPrimary:r,getSurface:g,setActiveMenuItem:m,toggleDarkMode:n}}const bt="integram-standalone",_t="1.0.0",kt="Integram Standalone Application with Login, Welcome, and Chat",St="module",wt={dev:"vite",build:"vite build",preview:"vite preview",backend:"cd backend/monolith && npm run dev",test:"playwright test","test:ui":"playwright test --ui","test:headed":"playwright test --headed","test:debug":"playwright test --debug","test:report":"playwright show-report"},It={"@fortawesome/fontawesome-free":"^6.7.2","@primevue/themes":"^4.2.6","@vueuse/core":"^14.1.0",axios:"^1.7.9","chart.js":"^4.4.7",dompurify:"^3.3.1",html2canvas:"^1.4.1",jspdf:"^3.0.4",marked:"^17.0.1",pinia:"^2.3.0",primeicons:"^7.0.0",primevue:"^4.2.6","socket.io-client":"^4.8.1",sortablejs:"^1.15.6",vue:"^3.5.13","vue-i18n":"^10.0.4","vue-router":"^4.5.0",xlsx:"https://cdn.sheetjs.com/xlsx-0.20.2/xlsx-0.20.2.tgz"},Ct={"@playwright/test":"^1.57.0","@vitejs/plugin-vue":"^5.2.1","sass-embedded":"^1.97.1",vite:"^6.0.3"},Re={name:bt,version:_t,description:kt,type:St,scripts:wt,dependencies:It,devDependencies:Ct};async function ze(){return{version:"1.0.0",environment:"development",deployedAt:new Date().toISOString(),branch:"main",commit:"unknown"}}const xt={__name:"AppFooter",setup(m,{expose:n}){n();const t=w(Re.version),e=w(!1),I=w(null),k=w(!0);let y=null;const r=async()=>{try{I.value=await ze()}catch(h){console.error("Failed to load deployment info:",h)}finally{k.value=!1}};se(async()=>{await r(),y=setInterval(r,3e5)}),ge(()=>{y&&clearInterval(y)});const u={version:t,showVersionTooltip:e,deploymentInfo:I,loading:k,get updateInterval(){return y},set updateInterval(h){y=h},fetchDeploymentInfo:r,formatDate:h=>{if(!h)return"Unknown";try{return new Date(h).toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return h}},getStatusClass:h=>{switch(h){case"synchronized":return"text-green-500";case"branch-mismatch":return"text-orange-500";case"unknown":case"error":return"text-red-500";default:return"text-muted-color"}},getStatusIcon:h=>{switch(h){case"synchronized":return"✓";case"branch-mismatch":return"⚠";case"unknown":case"error":return"✗";default:return"?"}},getStatusText:h=>{switch(h){case"synchronized":return"Синхронизирован с dev";case"branch-mismatch":return"Ветка не соответствует dev";case"unknown":return"Статус неизвестен";case"error":return"Ошибка получения статуса";default:return h}},ref:w,onMounted:se,onUnmounted:ge,get packageJson(){return Re},get getDeploymentInfo(){return ze}};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}},Mt={class:"layout-footer"},At={class:"flex flex-col gap-3"},Lt={class:"flex items-center justify-between flex-wrap gap-2"},Dt={class:"text-sm"},Tt=["title"],Pt={key:0,class:"deployment-info text-xs text-muted-color flex flex-wrap gap-3 justify-center items-center"},Rt={key:0,class:"flex items-center gap-1"},Ot={key:1,class:"flex items-center gap-1"},Et={key:2,class:"flex items-center gap-1"},Nt=["title"],Kt={key:1,class:"deployment-info text-xs text-muted-color text-center"},Vt={class:"flex flex-wrap gap-4 text-sm justify-center"};function Ut(m,n,t,e,I,k){const y=te("router-link");return c(),_("div",Mt,[i("div",At,[i("div",Lt,[i("p",Dt,[n[2]||(n[2]=ce("© 2025 Integram ",-1)),i("a",{href:"https://github.com/unidel2035/dronedoc2025/blob/master/CHANGELOG.md",target:"_blank",rel:"noopener noreferrer",class:"text-sm text-muted-color hover:text-primary transition-colors",onMouseenter:n[0]||(n[0]=r=>e.showVersionTooltip=!0),onMouseleave:n[1]||(n[1]=r=>e.showVersionTooltip=!1),title:`View changelog for version ${e.version}`}," v"+Z(e.version),41,Tt)])]),!e.loading&&e.deploymentInfo?(c(),_("div",Pt,[e.deploymentInfo.lastCommitDate?(c(),_("span",Rt,[n[3]||(n[3]=i("i",{class:"pi pi-clock"},null,-1)),i("span",null,"Обновлено: "+Z(e.formatDate(e.deploymentInfo.lastCommitDate)),1)])):A("",!0),e.deploymentInfo.branch?(c(),_("span",Ot,[n[4]||(n[4]=i("i",{class:"pi pi-code-branch"},null,-1)),i("span",null,"Ветка: "+Z(e.deploymentInfo.branch),1)])):A("",!0),e.deploymentInfo.commitHash?(c(),_("span",Et,[n[5]||(n[5]=i("i",{class:"pi pi-hashtag"},null,-1)),i("span",null,Z(e.deploymentInfo.commitHash),1)])):A("",!0),e.deploymentInfo.deploymentStatus?(c(),_("span",{key:3,class:U(["flex items-center gap-1 font-semibold",e.getStatusClass(e.deploymentInfo.deploymentStatus)]),title:e.deploymentInfo.lastCommitMessage},[i("span",null,Z(e.getStatusIcon(e.deploymentInfo.deploymentStatus)),1),i("span",null,Z(e.getStatusText(e.deploymentInfo.deploymentStatus)),1)],10,Nt)):A("",!0)])):e.loading?(c(),_("div",Kt,[...n[6]||(n[6]=[i("i",{class:"pi pi-spin pi-spinner"},null,-1),ce(" Загрузка информации о развертывании... ",-1)])])):A("",!0),i("div",Vt,[T(y,{to:"/legal/terms-of-service",class:"text-muted-color hover:text-primary transition-colors"},{default:F(()=>[...n[7]||(n[7]=[ce(" Условия использования ",-1)])]),_:1}),T(y,{to:"/legal/privacy-policy",class:"text-muted-color hover:text-primary transition-colors"},{default:F(()=>[...n[8]||(n[8]=[ce(" Политика конфиденциальности ",-1)])]),_:1}),T(y,{to:"/legal/cookie-policy",class:"text-muted-color hover:text-primary transition-colors"},{default:F(()=>[...n[9]||(n[9]=[ce(" Cookies ",-1)])]),_:1}),T(y,{to:"/legal/refund-policy",class:"text-muted-color hover:text-primary transition-colors"},{default:F(()=>[...n[10]||(n[10]=[ce(" Возврат средств ",-1)])]),_:1}),T(y,{to:"/legal/acceptable-use-policy",class:"text-muted-color hover:text-primary transition-colors"},{default:F(()=>[...n[11]||(n[11]=[ce(" Правила использования ",-1)])]),_:1}),T(y,{to:"/legal/dmca-policy",class:"text-muted-color hover:text-primary transition-colors"},{default:F(()=>[...n[12]||(n[12]=[ce(" DMCA ",-1)])]),_:1})])])])}const Bt=ae(xt,[["render",Ut],["__scopeId","data-v-772024c0"],["__file","/home/hive/integram-standalone/src/components/layout/AppFooter.vue"]]);function jt(m){return m}function Je(m,n){return{id:m,...n}}function He(m){return!0}function Te(m){return!1}function qe(m){return!0}function Ge(){return{prefetchRoute:()=>{},isPrefetched:()=>!1}}const Ft={__name:"AppMenuItem",props:{item:{type:Object,default:()=>({})},index:{type:Number,default:0},root:{type:Boolean,default:!0},parentItemKey:{type:String,default:null},searchQuery:{type:String,default:""},collapsed:{type:Boolean,default:!1}},emits:["rename","duplicate","toggle-visibility","delete","add-child","drag-drop","toggle-collapsed"],setup(m,{expose:n,emit:t}){n();const e=we(),I=Ke(),{onLinkHover:k,onLinkLeave:y}=Ge(),{layoutState:r,setActiveMenuItem:g,toggleMenu:M}=fe(),o=m,f=t,u=w(!1),h=w(null),p=w(),R=w(!1),O=w(""),j=w(!1),B=w(!1),z=w();let Q="",X=null;Ve(()=>{h.value=o.parentItemKey?o.parentItemKey+"-"+o.index:String(o.index);const l=r.activeMenuItem;o.root&&o.item.items&&o.item.items.length>0?(Te(o.item.label),u.value=!0):u.value=o.root||(l===h.value||l?l.startsWith(h.value+"-"):!1)}),W(()=>r.activeMenuItem,l=>{o.root&&o.item.items&&o.item.items.length>0?(Te(o.item.label),u.value=!0):u.value=o.root||l===h.value||(l?l.startsWith(h.value+"-"):!1)}),W(()=>o.searchQuery,l=>{if(l&&l.trim()!==""&&o.item.items&&o.item.items.length>0)u.value=!0;else if(!l||l.trim()==="")if(o.root&&o.item.items&&o.item.items.length>0)Te(o.item.label),u.value=!0;else{const v=r.activeMenuItem;u.value=v===h.value||(v?v.startsWith(h.value+"-"):!1)}});const le=(l,v)=>{if(!v||v.trim()===""||!l)return l;const N=new RegExp(`(${v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return l.replace(N,'<mark class="search-highlight">$1</mark>')},K=L(()=>le(o.item.label,o.searchQuery));function V(l,v){var J;if(v.disabled){l.preventDefault();return}if(o.collapsed&&v.items&&v.items.length>0){l.preventDefault(),(J=z.value)==null||J.toggle(l);return}if(v.to&&!v.items){l.preventDefault(),I.push(v.to),(r.staticMenuMobileActive||r.overlayMenuActive)&&M();const $=h.value;g($);return}if((v.to||v.url)&&(r.staticMenuMobileActive||r.overlayMenuActive)&&M(),v.command&&v.command({originalEvent:l,item:v}),o.root&&v.items&&v.items.length>0){const $=qe(v.label);u.value=!$,f("toggle-collapsed",{item:v,collapsed:$})}const N=v.items&&u.value?o.parentItemKey:h.value;g(N)}function ne(l,v){var N;l&&(l.preventDefault(),l.stopPropagation()),(N=z.value)==null||N.hide(),v.to&&I.push(v.to),(r.staticMenuMobileActive||r.overlayMenuActive)&&M()}function Ie(l){if(!l.to)return!1;const v=e.path.replace(/\/$/,"")||"/",N=l.to.replace(/\/$/,"")||"/";return v===N?!0:N==="/workspaces"?v==="/workspaces":N.startsWith("/workspace/")&&v.startsWith("/workspace/")?v===N:!1}function ie(){return o.item.label!=="Страницы"}function Ce(l){if(!ie()){l.preventDefault();return}j.value=!0,l.dataTransfer.effectAllowed="move",l.dataTransfer.setData("text/plain",JSON.stringify({index:o.index,parentItemKey:o.parentItemKey}))}function ue(l){ie()&&(l.preventDefault(),l.dataTransfer.dropEffect="move",B.value=!0)}function xe(){B.value=!1}function pe(l){if(l.preventDefault(),l.stopPropagation(),!!ie()){B.value=!1;try{const v=JSON.parse(l.dataTransfer.getData("text/plain"));f("drag-drop",{draggedIndex:v.index,draggedParentKey:v.parentItemKey,targetIndex:o.index,targetParentKey:o.parentItemKey})}catch(v){x.error("Error parsing drag data:",v)}}}function ve(){j.value=!1,B.value=!1}const _e=L(()=>{const l=[];return o.root||(l.push({label:"Переименовать",icon:"pi pi-pencil",command:()=>he()},{label:"Дублировать",icon:"pi pi-copy",command:()=>f("duplicate",o.item)}),o.item.to||l.push({label:"Добавить подпункт",icon:"pi pi-plus",command:()=>f("add-child",o.item)}),l.push({separator:!0},{label:o.item.visible!==!1?"Скрыть":"Показать",icon:o.item.visible!==!1?"pi pi-eye-slash":"pi pi-eye",command:()=>f("toggle-visibility",o.item)},{separator:!0},{label:"Удалить",icon:"pi pi-trash",command:()=>f("delete",o.item)}),o.item.to&&l.splice(l.length-2,0,{label:"Копировать ссылку",icon:"pi pi-link",command:()=>s()})),l}),Me=l=>{o.root||(l.preventDefault(),p.value.show(l))},he=()=>{R.value=!0,O.value=o.item.label},a=()=>{O.value&&O.value!==o.item.label&&f("rename",{item:o.item,newLabel:O.value}),R.value=!1},d=()=>{R.value=!1,O.value=""},s=()=>{o.item.to&&navigator.clipboard.writeText(o.item.to)};function S(){return Array.from(document.querySelectorAll('.layout-menu a[tabindex="0"]:not([style*="display: none"])'))}function b(){const l=S(),v=l.indexOf(document.activeElement);v>0&&l[v-1].focus()}function C(){const l=S(),v=l.indexOf(document.activeElement);v<l.length-1&&l[v+1].focus()}function P(){const l=S();l.length>0&&l[0].focus()}function Y(){const l=S();l.length>0&&l[l.length-1].focus()}function D(){if(o.parentItemKey){const l=document.querySelector(`[data-key="${o.parentItemKey}"]`);l&&l.focus()}}function E(l){switch(l.key){case"ArrowUp":l.preventDefault(),b();break;case"ArrowDown":l.preventDefault(),C();break;case"ArrowRight":o.item.items&&!u.value&&(l.preventDefault(),g(h.value));break;case"ArrowLeft":u.value&&o.item.items?(l.preventDefault(),g(o.parentItemKey)):o.parentItemKey&&(l.preventDefault(),D());break;case"Home":l.preventDefault(),P();break;case"End":l.preventDefault(),Y();break;case" ":o.item.items&&(l.preventDefault(),V(l,o.item));break;case"Escape":u.value&&(l.preventDefault(),g(o.parentItemKey));break}}function oe(l){if(l.ctrlKey||l.metaKey||l.altKey||l.key.length>1)return;clearTimeout(X),Q+=l.key.toLowerCase();const v=S(),N=v.indexOf(document.activeElement);for(let J=N+1;J<v.length;J++)if(v[J].textContent.trim().toLowerCase().startsWith(Q)){v[J].focus();return}for(let J=0;J<=N;J++)if(v[J].textContent.trim().toLowerCase().startsWith(Q)){v[J].focus();return}X=setTimeout(()=>{Q=""},1e3)}const ye={route:e,router:I,onLinkHover:k,onLinkLeave:y,layoutState:r,setActiveMenuItem:g,toggleMenu:M,props:o,emit:f,isActiveMenu:u,itemKey:h,menuRef:p,isEditing:R,editedLabel:O,isDragging:j,isDragOver:B,submenuOverlay:z,get typeaheadBuffer(){return Q},set typeaheadBuffer(l){Q=l},get typeaheadTimeout(){return X},set typeaheadTimeout(l){X=l},highlightMatch:le,highlightedLabel:K,itemClick:V,onSubmenuItemClick:ne,checkActiveRoute:Ie,isDraggable:ie,onDragStart:Ce,onDragOver:ue,onDragLeave:xe,onDrop:pe,onDragEnd:ve,contextMenuItems:_e,onRightClick:Me,startRename:he,saveRename:a,cancelRename:d,copyLink:s,getAllFocusableItems:S,focusPreviousItem:b,focusNextItem:C,focusFirstItem:P,focusLastItem:Y,focusParentItem:D,onKeyDown:E,onKeyPress:oe,get useLayout(){return fe},onBeforeMount:Ve,ref:w,watch:W,computed:L,get useRoute(){return we},get useRouter(){return Ke},get isGroupCollapsed(){return Te},get toggleGroupCollapsed(){return qe},get logger(){return x},get useRoutePrefetch(){return Ge}};return Object.defineProperty(ye,"__isScriptSetup",{enumerable:!1,value:!0}),ye}},Wt=["role","aria-expanded","draggable"],zt=["aria-expanded","tabindex"],Jt={key:0,class:"pi pi-bars drag-handle"},Ht=["innerHTML"],qt=["href","target","data-key","data-parent","aria-label"],Gt=["href","target","data-key","data-parent","aria-label"],Qt={key:0,class:"pi pi-bars drag-handle"},Xt=["innerHTML"],Yt={key:4,class:"pi pi-fw pi-angle-down layout-submenu-toggler"},Zt={key:0,class:"pi pi-bars drag-handle"},$t=["innerHTML"],en={key:4,class:"pi pi-fw pi-angle-down layout-submenu-toggler"},tn={class:"layout-submenu",role:"group"},nn={class:"submenu-overlay-content"},on={class:"submenu-overlay-header"},an={class:"font-semibold"},ln={class:"submenu-overlay-items"},rn=["onClick","onMouseenter","onMouseleave"],sn={key:1,class:"submenu-overlay-group"},un={class:"submenu-overlay-group-label"},cn={class:"submenu-overlay-group-items"},dn=["onClick","onMouseenter","onMouseleave"];function mn(m,n,t,e,I,k){const y=te("InputText"),r=te("router-link"),g=te("app-menu-item",!0),M=te("ContextMenu"),o=te("OverlayPanel"),f=Oe("tooltip");return c(),_("li",{class:U({"layout-root-menuitem":t.root,"active-menuitem":e.isActiveMenu,"menu-item-dragging":e.isDragging,"menu-item-drag-over":e.isDragOver}),role:t.root?"none":"treeitem","aria-expanded":t.item.items?e.isActiveMenu:void 0,draggable:e.isDraggable(),onDragstart:e.onDragStart,onDragover:e.onDragOver,onDragleave:e.onDragLeave,onDrop:e.onDrop,onDragend:e.onDragEnd,onContextmenu:e.onRightClick},[t.root&&t.item.visible!==!1&&!t.collapsed?(c(),_("div",{key:0,class:U(["layout-menuitem-root-text",{"collapsible-group":t.item.items&&t.item.items.length>0}]),onClick:n[0]||(n[0]=u=>t.item.items&&t.item.items.length>0?e.itemClick(u,t.item):null),role:"button","aria-expanded":t.item.items?e.isActiveMenu:void 0,tabindex:t.item.items&&t.item.items.length>0?0:-1,onKeydown:[n[1]||(n[1]=ke(u=>t.item.items&&t.item.items.length>0?e.itemClick(u,t.item):null,["enter"])),n[2]||(n[2]=ke(ct(u=>t.item.items&&t.item.items.length>0?e.itemClick(u,t.item):null,["prevent"]),["space"]))]},[e.isDraggable()?(c(),_("i",Jt)):A("",!0),i("span",{innerHTML:e.highlightedLabel},null,8,Ht),t.item.items&&t.item.items.length>0?(c(),_("i",{key:1,class:U(["pi pi-fw layout-group-toggler",e.isActiveMenu?"pi-chevron-down":"pi-chevron-right"])},null,2)):A("",!0)],42,zt)):A("",!0),t.root&&t.item.visible!==!1&&t.collapsed&&t.item.icon?be((c(),_("a",{key:1,href:t.item.url,onClick:n[3]||(n[3]=u=>e.itemClick(u,t.item,t.index)),onKeydown:e.onKeyDown,onKeypress:e.onKeyPress,class:U(t.item.class),target:t.item.target,tabindex:"0","data-key":e.itemKey,"data-parent":t.parentItemKey,"aria-label":t.item.label},[i("i",{class:U([t.item.icon,"layout-menuitem-icon"])},null,2)],42,qt)),[[f,t.item.label,void 0,{right:!0}]]):A("",!0),!t.root&&(!t.item.to||t.item.items)&&t.item.visible!==!1?be((c(),_("a",{key:2,href:t.item.url,onClick:n[5]||(n[5]=u=>e.itemClick(u,t.item,t.index)),onKeydown:e.onKeyDown,onKeypress:e.onKeyPress,class:U(t.item.class),target:t.item.target,tabindex:"0","data-key":e.itemKey,"data-parent":t.parentItemKey,"aria-label":t.item.label},[e.isDraggable()&&!t.collapsed?(c(),_("i",Qt)):A("",!0),t.item.icon?(c(),_("i",{key:1,class:U([t.item.icon,"layout-menuitem-icon"])},null,2)):A("",!0),!e.isEditing&&!t.collapsed?(c(),_("span",{key:2,class:"layout-menuitem-text",innerHTML:e.highlightedLabel},null,8,Xt)):e.isEditing&&!t.collapsed?(c(),G(y,{key:3,modelValue:e.editedLabel,"onUpdate:modelValue":n[4]||(n[4]=u=>e.editedLabel=u),onBlur:e.saveRename,onKeyup:[ke(e.saveRename,["enter"]),ke(e.cancelRename,["esc"])],autofocus:"",class:"layout-menuitem-text p-inputtext-sm",style:{width:"100%","max-width":"200px"}},null,8,["modelValue"])):A("",!0),t.item.items&&!t.collapsed?(c(),_("i",Yt)):A("",!0)],42,Gt)),[[f,t.collapsed?t.item.label:null,void 0,{right:!0}]]):A("",!0),t.item.to&&!t.item.items&&t.item.visible!==!1?be((c(),G(r,{key:3,onClick:n[7]||(n[7]=u=>e.itemClick(u,t.item,t.index)),onKeydown:e.onKeyDown,onKeypress:e.onKeyPress,onMouseenter:n[8]||(n[8]=u=>e.onLinkHover(t.item.to)),onMouseleave:n[9]||(n[9]=u=>e.onLinkLeave(t.item.to)),class:U([t.item.class,{"active-route":e.checkActiveRoute(t.item)}]),tabindex:"0",to:t.item.to,"data-key":e.itemKey,"data-parent":t.parentItemKey,"aria-label":t.item.label,"aria-current":e.checkActiveRoute(t.item)?"page":void 0},{default:F(()=>[!t.root&&e.isDraggable()&&!t.collapsed?(c(),_("i",Zt)):A("",!0),t.item.icon?(c(),_("i",{key:1,class:U([t.item.icon,"layout-menuitem-icon"])},null,2)):A("",!0),!e.isEditing&&!t.collapsed?(c(),_("span",{key:2,class:"layout-menuitem-text",innerHTML:e.highlightedLabel},null,8,$t)):e.isEditing&&!t.collapsed?(c(),G(y,{key:3,modelValue:e.editedLabel,"onUpdate:modelValue":n[6]||(n[6]=u=>e.editedLabel=u),onBlur:e.saveRename,onKeyup:[ke(e.saveRename,["enter"]),ke(e.cancelRename,["esc"])],autofocus:"",class:"layout-menuitem-text p-inputtext-sm",style:{width:"100%","max-width":"200px"}},null,8,["modelValue"])):A("",!0),t.item.items&&!t.collapsed?(c(),_("i",en)):A("",!0)]),_:1},8,["class","to","data-key","data-parent","aria-label","aria-current"])),[[f,t.collapsed?t.item.label:null,void 0,{right:!0}]]):A("",!0),t.item.items&&t.item.visible!==!1&&!t.collapsed?(c(),G(it,{key:4,name:"layout-submenu"},{default:F(()=>[be(i("ul",tn,[(c(!0),_(me,null,Le(t.item.items,(u,h)=>(c(),G(g,{key:u,index:h,item:u,parentItemKey:e.itemKey,root:!1,"search-query":t.searchQuery,collapsed:t.collapsed,onRename:n[10]||(n[10]=p=>m.$emit("rename",p)),onDuplicate:n[11]||(n[11]=p=>m.$emit("duplicate",p)),onToggleVisibility:n[12]||(n[12]=p=>m.$emit("toggle-visibility",p)),onDelete:n[13]||(n[13]=p=>m.$emit("delete",p)),onAddChild:n[14]||(n[14]=p=>m.$emit("add-child",p)),onDragDrop:n[15]||(n[15]=p=>m.$emit("drag-drop",p))},null,8,["index","item","parentItemKey","search-query","collapsed"]))),128))],512),[[Ne,e.isActiveMenu]])]),_:1})):A("",!0),t.root?A("",!0):(c(),G(M,{key:5,ref:"menuRef",model:e.contextMenuItems},null,8,["model"])),t.item.items&&t.item.items.length>0&&t.collapsed?(c(),G(o,{key:6,ref:"submenuOverlay",dismissable:!0,showCloseIcon:!1},{default:F(()=>[i("div",nn,[i("div",on,[t.item.icon?(c(),_("i",{key:0,class:U([t.item.icon,"mr-2"])},null,2)):A("",!0),i("span",an,Z(t.item.label),1)]),i("div",ln,[(c(!0),_(me,null,Le(t.item.items,(u,h)=>(c(),_(me,{key:h},[u.visible!==!1&&!u.items?(c(),_("div",{key:0,class:"submenu-overlay-item",onClick:p=>e.onSubmenuItemClick(p,u),onMouseenter:p=>u.to&&e.onLinkHover(u.to),onMouseleave:p=>u.to&&e.onLinkLeave(u.to),role:"menuitem",tabindex:"0"},[u.icon?(c(),_("i",{key:0,class:U([u.icon,"mr-2"])},null,2)):A("",!0),i("span",null,Z(u.label),1)],40,rn)):u.visible!==!1&&u.items?(c(),_("div",sn,[i("div",un,[u.icon?(c(),_("i",{key:0,class:U([u.icon,"mr-2"])},null,2)):A("",!0),i("span",null,Z(u.label),1)]),i("div",cn,[(c(!0),_(me,null,Le(u.items,(p,R)=>be((c(),_("div",{key:R,class:"submenu-overlay-item submenu-overlay-item-nested",onClick:O=>e.onSubmenuItemClick(O,p),onMouseenter:O=>p.to&&e.onLinkHover(p.to),onMouseleave:O=>p.to&&e.onLinkLeave(p.to),role:"menuitem",tabindex:"0"},[p.icon?(c(),_("i",{key:0,class:U([p.icon,"mr-2"])},null,2)):A("",!0),i("span",null,Z(p.label),1)],40,dn)),[[Ne,p.visible!==!1]])),128))])])):A("",!0)],64))),128))])])]),_:1},512)):A("",!0)],42,Wt)}const gn=ae(Ft,[["render",mn],["__scopeId","data-v-db773dfd"],["__file","/home/hive/integram-standalone/src/components/layout/AppMenuItem.vue"]]),Ae={getMenuConfig:()=>Promise.resolve([]),getLocalMenuConfig:()=>[],saveMenuConfig:()=>Promise.resolve(!0),resetToDefault:()=>Promise.resolve(!0)};function Qe(m){return console.warn("workspaceService: Using stub implementation"),Promise.resolve([])}const fn={__name:"AppMenu",props:{searchQuery:{type:String,default:""},collapsed:{type:Boolean,default:!1}},emits:["menu-loaded"],setup(m,{expose:n,emit:t}){n();const e=Fe(),I=m,k=w("");let y=null;W(()=>I.searchQuery,a=>{clearTimeout(y);const d=!a||a.trim()===""?50:150;y=setTimeout(()=>{k.value=a||""},d)},{flush:"post"});let r=null;const g=()=>(r||(r=Ue()),r),M=t,o=w([]),f=w(!1),u=w(!0),h=w([]),p=w(!1),R=[{label:"Workspaces",icon:"pi pi-fw pi-folder-open",items:[]},{label:"Документы",icon:"pi pi-fw pi-file",items:[]}],O=[{label:"Главная",icon:"pi pi-fw pi-home",items:[{label:"Добро пожаловать",icon:"pi pi-fw pi-home",to:"/"},{label:"О платформе",icon:"pi pi-fw pi-info-circle",to:"/about"}]},{label:"Начать работу",icon:"pi pi-fw pi-sign-in",items:[{label:"Вход",icon:"pi pi-fw pi-sign-in",to:"/login"},{label:"Регистрация",icon:"pi pi-fw pi-user-plus",to:"/register"}]}],j=()=>{try{const a=localStorage.getItem("apiBase");return!a||a===""||a===window.location.hostname||a==="localhost"||a==="app.integram.io"}catch(a){return x.error("Ошибка при чтении apiBase из localStorage:",a),!0}},B=async()=>{try{return localStorage.getItem("token")?(f.value=!0,x.debug("User role detection (using default admin access):",{isAdmin:f.value}),f.value):(x.warn("No authentication token found"),f.value=!1,!1)}catch(a){return x.error("Ошибка при проверке роли пользователя:",a),f.value=!1,!1}},z=async()=>{if(p.value)return;if(!(localStorage.getItem("token")||localStorage.getItem("my_token"))){x.debug("Skipping workspace loading for non-authorized user");return}try{const d=e.primaryUserId||localStorage.getItem("id")||"default-user";x.debug("Loading user workspaces...",{userId:d,authStorePrimaryUserId:e.primaryUserId,localStorageId:localStorage.getItem("id"),apiUrl:"http://localhost:3000"});const s=await Qe(d);h.value=s||[],p.value=!0,x.debug("Loaded workspaces:",{count:h.value.length,workspaces:h.value.map(S=>({id:S.id,name:S.name}))}),Q()}catch(d){x.error("Failed to load user workspaces:",{error:d.message,stack:d.stack}),h.value=[],p.value=!0,Q()}},Q=()=>{let a=o.value.find(s=>s.label==="Workspaces");a||(a={label:"Workspaces",icon:"pi pi-fw pi-folder-open",items:[]},o.value.unshift(a));const d=[{label:"Все Workspaces",icon:"pi pi-fw pi-list",to:"/workspaces"}];h.value.length>0&&h.value.forEach(s=>{d.push({label:s.name,icon:s.agentEnabled?"pi pi-fw pi-bolt":"pi pi-fw pi-folder",to:`/workspace/${s.id}`,workspaceId:s.id})}),a.items=d,x.debug("Workspaces section populated:",{itemCount:d.length})},X=async()=>{try{const a=JSON.stringify(o.value);await Ae.saveMenuConfig(a)}catch(a){x.error("Error saving menu config:",a)}},le=(a,d)=>{for(let s=0;s<a.length;s++){if(a[s]===d)return{parent:a,index:s,item:a[s]};if(a[s].items){const S=le(a[s].items,d);if(S)return S}}return null},K=async a=>{const{item:d,newLabel:s}=a,S=d.label;if(d.label=s,d.id||d.dbId)try{await Je(d.id||d.dbId,{label:s}),x.debug("Menu item renamed in database:",{id:d.id||d.dbId,newLabel:s}),g().add({severity:"success",summary:"Успешно",detail:"Пункт меню переименован",life:2e3})}catch(b){x.error("Failed to rename menu item in database:",b),d.label=S,g().add({severity:"error",summary:"Ошибка",detail:"Не удалось переименовать пункт меню в базе данных",life:3e3});return}await X()},V=async a=>{const d=le(o.value,a);if(d){const s=JSON.parse(JSON.stringify(a));s.label=`${a.label} (копия)`,delete s.id,delete s.dbId;const S=o.value.find(b=>b.items&&b.items.includes(a));if(S&&S.fromAppMenu)try{const b=await{label:s.label,path:s.to||"/",icon:s.icon||"pi pi-fw pi-file",group:S.label||"Страницы"};s.id=b.id,x.debug("Menu item duplicated in database:",b),g().add({severity:"success",summary:"Успешно",detail:"Пункт меню дублирован",life:2e3})}catch(b){x.error("Failed to duplicate menu item in database:",b),g().add({severity:"error",summary:"Ошибка",detail:"Не удалось дублировать пункт меню в базе данных",life:3e3});return}d.parent.splice(d.index+1,0,s),await X()}},ne=async a=>{a.visible=a.visible===!1,await X()},Ie=async a=>{const d=le(o.value,a);if(d){if(a.id||a.dbId)try{await He(a.id||a.dbId),x.debug("Menu item deleted from database:",{id:a.id||a.dbId}),g().add({severity:"success",summary:"Успешно",detail:"Пункт меню удалён",life:2e3})}catch(s){x.error("Failed to delete menu item from database:",s),g().add({severity:"error",summary:"Ошибка",detail:"Не удалось удалить пункт меню из базы данных",life:3e3});return}d.parent.splice(d.index,1),await X()}},ie=async a=>{a.items||(a.items=[]);const d={label:"Новый пункт",icon:"pi pi-fw pi-file",to:"/new-path"};if(a.fromAppMenu)try{const s=await{label:d.label,path:d.to,icon:d.icon,group:a.label||"Страницы"};d.id=s.id,x.debug("New menu item created in database:",s),g().add({severity:"success",summary:"Успешно",detail:"Новый пункт меню создан",life:2e3})}catch(s){x.error("Failed to create menu item in database:",s),g().add({severity:"error",summary:"Ошибка",detail:"Не удалось создать пункт меню в базе данных",life:3e3});return}a.items.push(d),await X()},Ce=async()=>{try{const a=localStorage.getItem("apiBase")||window.location.hostname,d=`https://${a}`;let s=null,S=null;if(s=localStorage.getItem("my_token"),S=localStorage.getItem("my_xsrf"),!s){const C=localStorage.getItem("integram_session");if(C)try{const P=JSON.parse(C);P.database==="my"&&(s=P.token,S=P.xsrfToken)}catch(P){x.warn("Failed to parse integram_session for app_menu:",P)}}if(s||(s=localStorage.getItem("token"),S=localStorage.getItem("_xsrf")),!s)return x.warn("No token available for app_menu request"),[];x.debug("Загрузка бокового меню из отчёта app_menu (база my)",{serverUrl:d,apiBase:a,hasToken:!!s}),De.setServer(d),De.setCredentials("my",s,S,"my");const b=await De.get("report/app_menu",{JSON_KV:!0});if(x.debug("Ответ от отчёта app_menu:",{hasResponse:!!b,isArray:Array.isArray(b),itemCount:Array.isArray(b)?b.length:0,firstItemKeys:Array.isArray(b)&&b[0]?Object.keys(b[0]):[]}),b&&Array.isArray(b)&&b.length>0){const C=new Map,P=[];for(const D of b){const E=D.Название||D.название||"",oe=D.path||D.Path||D.Маршрут||D.маршрут||"/",ye=D.Иконка||D.иконка||D.icon||D.Icon||"pi pi-fw pi-file",l=D["Группа меню"]||D["группа меню"]||D.Группа||D.группа||D.group||D.Group||"Прочее",v=String(E).replace(/<[^>]*>/g,"").trim(),N=String(oe).replace(/<[^>]*>/g,"").trim(),J=String(ye).replace(/<[^>]*>/g,"").trim(),$=String(l).replace(/<[^>]*>/g,"").trim();if(v&&v!=="null"&&v!==""){const H={label:v,icon:J,to:N.startsWith("/")?N:`/${N}`};C.has($)||(C.set($,[]),P.push($)),C.get($).push(H)}}const Y=[];for(const D of P){const E=C.get(D),oe=E.length>0?E[0].icon:"pi pi-fw pi-folder";Y.push({label:D,icon:oe,items:E})}return x.debug("Загружено групп меню из отчёта app_menu:",{groupCount:Y.length,serverUrl:d,totalItems:b.length}),Y}return[]}catch(a){return x.error("Ошибка загрузки бокового меню из отчёта app_menu:",a),[]}},ue=async()=>{u.value=!0,await B(),x.debug("User role check:",{isAdmin:f.value,shouldShowBase:j()});let a=!1;if(f.value){const S=Ae.getLocalMenuConfig();if(S)try{o.value=JSON.parse(S),a=!0,x.debug("Loaded custom menu from localStorage for admin")}catch(b){x.error("Error parsing local menu config:",b)}if(!a)try{const b=await Ae.getMenuConfig();b&&b.response&&b.response.config&&(o.value=JSON.parse(b.response.config),a=!0,x.debug("Loaded custom menu from server for admin"))}catch{x.debug("Using default menu (orchestrator not available)")}}if(a||(f.value&&j()?(o.value=[...R],x.debug("Using baseMenu for admin user")):(o.value=[...O],x.debug("Using userMenu for non-admin user (Участник)"))),!(localStorage.getItem("token")||localStorage.getItem("my_token"))){x.info("Non-authorized user detected, using public menu only"),u.value=!1;return}let s=o.value.find(S=>S.label==="Документы");s||(o.value.push({label:"Документы",icon:"pi pi-fw pi-file",items:[{label:"Все страницы",icon:"pi pi-fw pi-list",to:"/pages"}]}),s=o.value[o.value.length-1],x.debug("Created Pages section with default fallback link"));try{let S=localStorage.getItem("my_token")||localStorage.getItem("token");const b=localStorage.getItem("user")||localStorage.getItem("my_user");if(S&&b){const P=`https://${window.location.hostname}/api/v2/integram/databases/my/reports/myrolemenu`,Y=await fetch(P,{headers:{"X-Authorization":S,"Content-Type":"application/json"}});if(!Y.ok)throw new Error(`API v2 error: ${Y.status}`);const E=(await Y.json()).data;E&&Array.isArray(E)&&E.length>0&&(s.items=E.map(oe=>({label:oe.Name||oe.Name,to:oe.HREF||oe.HREF,icon:"pi pi-fw pi-link"})),x.debug("Loaded MyRoleMenu items via API v2:",s.items.length))}}catch(S){x.error("Failed to load MyRoleMenu:",S)}u.value=!1},xe=async a=>{const{draggedIndex:d,draggedParentKey:s,targetIndex:S,targetParentKey:b}=a;if(d===S&&s===b)return;const C=JSON.parse(JSON.stringify(o.value));if(!s&&!b){const H=C[d],Ee=["Документы","Workspaces"];if(Ee.includes(H.label)||Ee.includes(C[S].label)){g().add({severity:"warn",summary:"Недоступно",detail:"Нельзя перемещать этот раздел (он генерируется автоматически)",life:3e3});return}C.splice(d,1);const ut=d<S?S-1:S;C.splice(ut,0,H),o.value=C,await pe();return}const P=parseInt((s==null?void 0:s.split("-")[0])||"0"),Y=parseInt((b==null?void 0:b.split("-")[0])||"0"),D=o.value[P],E=o.value[Y],oe=["Документы","Workspaces"];if(oe.includes(D==null?void 0:D.label)||oe.includes(E==null?void 0:E.label)){g().add({severity:"warn",summary:"Недоступно",detail:"Нельзя перемещать элементы этого раздела (они генерируются автоматически)",life:3e3});return}const ye=s?s.split("-").map(H=>parseInt(H)):[],l=b?b.split("-").map(H=>parseInt(H)):[];let v=C;for(let H=0;H<ye.length;H++)v=v[ye[H]].items;let N=C;for(let H=0;H<l.length;H++)N=N[l[H]].items;const J=v[d];v.splice(d,1);let $=S;s===b&&d<S&&$--,N.splice($,0,J),o.value=C,await pe()},pe=async()=>{try{const a=["Документы","Workspaces"],d=o.value.filter(S=>!a.includes(S.label)),s=JSON.stringify(d);await Ae.saveMenuConfig(s),g().add({severity:"success",summary:"Сохранено",detail:"Порядок меню автоматически сохранён",life:2e3})}catch{g().add({severity:"error",summary:"Ошибка",detail:"Не удалось сохранить порядок меню",life:3e3})}};se(async()=>{await ue(),await z()});const ve=(a,d)=>!a||a.length===0?[]:a.reduce((s,S)=>{const b={...S};let C=!1;if(b.label&&b.label.toLowerCase().includes(d)&&(C=!0),b.items&&b.items.length>0){const P=ve(b.items,d);P.length>0&&(b.items=P,C=!0)}return C&&s.push(b),s},[]),_e=L(()=>{let a=o.value;if(k.value&&k.value.trim()!==""){const d=k.value.toLowerCase().trim();a=ve(a,d)}return a});W(()=>I.searchQuery,async a=>{a&&a.trim()!==""&&(p.value||await z())});const Me=L(()=>{if(!k.value||k.value.trim()==="")return 0;let a=0;const d=s=>{s.forEach(S=>{S.label&&a++,S.items&&d(S.items)})};return d(_e.value),a});W(o,a=>{M("menu-loaded",a)},{deep:!0,immediate:!0});const he={authStore:e,props:I,debouncedSearchQuery:k,get searchDebounceTimer(){return y},set searchDebounceTimer(a){y=a},get toast(){return r},set toast(a){r=a},getToast:g,emit:M,model:o,isAdmin:f,loading:u,userWorkspaces:h,workspacesLoaded:p,baseMenu:R,userMenu:O,shouldShowBaseMenu:j,checkUserRole:B,loadUserWorkspaces:z,populateWorkspacesSection:Q,saveMenuConfig:X,findItemInMenu:le,handleRename:K,handleDuplicate:V,handleToggleVisibility:ne,handleDelete:Ie,handleAddChild:ie,loadSidebarMenuFromIntegram:Ce,fetchMenuItems:ue,handleDragDrop:xe,saveMenuOrder:pe,filterMenuItems:ve,filteredModel:_e,filteredItemsCount:Me,get logger(){return x},ref:w,onMounted:se,computed:L,watch:W,get useToast(){return Ue},AppMenuItem:gn,get apiClient(){return pt},get MenuConfigService(){return Ae},get integramApiClient(){return De},get createMenuItem(){return jt},get updateMenuItem(){return Je},get deleteMenuItem(){return He},get getUserWorkspaces(){return Qe},get useAuthStore(){return Fe}};return Object.defineProperty(he,"__isScriptSetup",{enumerable:!1,value:!0}),he}},pn={key:0,class:"flex justify-content-center align-items-center h-full"},vn={key:1},hn={key:0,class:"search-results-info px-3 py-2 text-sm text-600"},yn={class:"layout-menu",role:"tree","aria-label":"Главное меню навигации"},bn={key:1,class:"menu-separator"},_n={key:1,class:"px-3 py-4 text-center text-500"};function kn(m,n,t,e,I,k){const y=te("ProgressSpinner");return e.loading?(c(),_("div",pn,[T(y)])):(c(),_("div",vn,[e.debouncedSearchQuery&&e.debouncedSearchQuery.trim()!==""?(c(),_("div",hn," Найдено: "+Z(e.filteredItemsCount)+" элементов ",1)):A("",!0),i("ul",yn,[(c(!0),_(me,null,Le(e.filteredModel,(r,g)=>(c(),_(me,{key:r.label||g},[r.separator?A("",!0):(c(),G(e.AppMenuItem,{key:0,item:r,index:g,"search-query":e.debouncedSearchQuery,collapsed:t.collapsed,onRename:e.handleRename,onDuplicate:e.handleDuplicate,onToggleVisibility:e.handleToggleVisibility,onDelete:e.handleDelete,onAddChild:e.handleAddChild,onDragDrop:e.handleDragDrop},null,8,["item","index","search-query","collapsed"])),r.separator?(c(),_("li",bn)):A("",!0)],64))),128))]),e.debouncedSearchQuery&&e.debouncedSearchQuery.trim()!==""&&e.filteredModel.length===0?(c(),_("div",_n," Ничего не найдено ")):A("",!0)]))}const Sn=ae(fn,[["render",kn],["__file","/home/hive/integram-standalone/src/components/layout/AppMenu.vue"]]),wn={__name:"SmartSearchResults",props:{results:{type:Object,default:()=>({})},query:{type:String,default:""},loading:{type:Boolean,default:!1}},emits:["navigate"],setup(m,{expose:n}){n();const t={};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}};function In(m,n,t,e,I,k){return A("",!0)}const Cn=ae(wn,[["render",In],["__file","/home/hive/integram-standalone/src/components/SmartSearchResults.vue"]]);function Xe(m,n,t,e){setTimeout(()=>{typeof e=="function"&&e({routes:[],agents:[],integrамResults:[],aiResults:[]})},100)}const xn={__name:"AppSidebar",setup(m,{expose:n}){n();const t=we(),{layoutState:e,toggleSidebarCollapse:I}=fe(),k=w(""),y=w(null),r=w(null),g=w(!1),M=w([]),o=p=>{var R,O,j,B;if(p.key==="/"&&!p.ctrlKey&&!p.metaKey&&!p.altKey&&((R=document.activeElement)==null?void 0:R.tagName)!=="INPUT"&&((O=document.activeElement)==null?void 0:O.tagName)!=="TEXTAREA"&&(p.preventDefault(),(B=(j=y.value)==null?void 0:j.$el)==null||B.focus()),p.key==="Escape"&&k.value&&(k.value=""),p.key==="ArrowDown"&&k.value&&u.value){p.preventDefault();const z=document.querySelector(".search-item");z&&z.focus()}};W(k,p=>{if(!p||p.trim()===""){r.value=null,g.value=!1;return}g.value=!0,Xe(p,M.value,{},R=>{r.value=R,g.value=!1,x.debug("Smart search results:",R)})},{flush:"post"}),W(()=>t.path,()=>{k.value=""}),W(()=>e.sidebarCollapsed,(p,R)=>{R===!0&&p===!1&&(k.value="")},{flush:"post"});const f=()=>{k.value=""},u=L(()=>r.value?r.value.routes.length>0||r.value.agents.length>0||r.value.integrамResults.length>0||r.value.aiResults.length>0:!1);se(()=>{document.addEventListener("keydown",o),k.value=""}),ge(()=>{document.removeEventListener("keydown",o)});const h={route:t,layoutState:e,toggleSidebarCollapse:I,searchQuery:k,searchInputRef:y,searchResults:r,searchLoading:g,menuModel:M,handleKeyDown:o,handleNavigate:f,hasExtraResults:u,ref:w,onMounted:se,onUnmounted:ge,watch:W,computed:L,get useRoute(){return we},get useLayout(){return fe},AppMenu:Sn,SmartSearchResults:Cn,get debouncedSmartSearch(){return Xe},get logger(){return x}};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}},Mn={class:"sidebar-header"},An={class:"sidebar-search p-3"},Ln={key:0,id:"smart-search-extras",class:"smart-search-extras"};function Dn(m,n,t,e,I,k){const y=te("Button"),r=te("InputIcon"),g=te("InputText"),M=te("IconField"),o=Oe("tooltip");return c(),_("div",{class:U(["layout-sidebar",{"sidebar-collapsed":e.layoutState.sidebarCollapsed}])},[i("div",Mn,[be(T(y,{icon:e.layoutState.sidebarCollapsed?"pi pi-angle-right":"pi pi-angle-left",onClick:e.toggleSidebarCollapse,class:"p-button-text p-button-rounded sidebar-toggle-btn","aria-label":"Переключить меню"},null,8,["icon","onClick"]),[[o,e.layoutState.sidebarCollapsed?"Развернуть меню":"Свернуть меню",void 0,{right:!0}]])]),i("div",An,[T(M,{iconPosition:"left"},{default:F(()=>[T(r,{class:"pi pi-search","aria-hidden":"true"}),T(g,{ref:"searchInputRef",modelValue:e.searchQuery,"onUpdate:modelValue":n[0]||(n[0]=f=>e.searchQuery=f),placeholder:"Поиск...",class:"w-full",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",role:"searchbox","aria-label":"Поиск по меню и страницам","aria-controls":"smart-search-extras"},null,8,["modelValue"])]),_:1})]),i("div",null,[T(e.AppMenu,{"search-query":e.searchQuery,collapsed:e.layoutState.sidebarCollapsed,onMenuLoaded:n[1]||(n[1]=f=>e.menuModel=f)},null,8,["search-query","collapsed"])]),e.hasExtraResults&&!e.layoutState.sidebarCollapsed?(c(),_("div",Ln,[T(e.SmartSearchResults,{results:e.searchResults,query:e.searchQuery,loading:e.searchLoading,onNavigate:e.handleNavigate},null,8,["results","query","loading"])])):A("",!0)],2)}const Tn=ae(xn,[["render",Dn],["__scopeId","data-v-0355add9"],["__file","/home/hive/integram-standalone/src/components/layout/AppSidebar.vue"]]),Ye=[{name:"blue",file:"/demo/images/dd2.svg",color:"#3b82f6",label:"Синий"},{name:"red",file:"/demo/images/dd3.svg",color:"#ef4444",label:"Красный"},{name:"green",file:"/demo/images/dd4.svg",color:"#22c55e",label:"Зелёный"},{name:"purple",file:"/demo/images/dd5.svg",color:"#a855f7",label:"Фиолетовый"},{name:"cyan",file:"/demo/images/dd6.svg",color:"#06b6d4",label:"Голубой"},{name:"pink",file:"/demo/images/dd7.svg",color:"#ec4899",label:"Розовый"},{name:"gray",file:"/demo/images/dd8.svg",color:"#6b7280",label:"Серый"}],Ze=[{name:"cyan",color:"#06b6d4",label:"Голубой"},{name:"blue",color:"#3b82f6",label:"Синий"},{name:"indigo",color:"#6366f1",label:"Индиго"},{name:"violet",color:"#8b5cf6",label:"Фиолетовый"},{name:"purple",color:"#a855f7",label:"Пурпурный"},{name:"pink",color:"#ec4899",label:"Розовый"},{name:"red",color:"#ef4444",label:"Красный"},{name:"orange",color:"#f97316",label:"Оранжевый"},{name:"amber",color:"#f59e0b",label:"Янтарный"},{name:"yellow",color:"#eab308",label:"Жёлтый"},{name:"lime",color:"#84cc16",label:"Лайм"},{name:"green",color:"#22c55e",label:"Зелёный"},{name:"emerald",color:"#10b981",label:"Изумрудный"},{name:"teal",color:"#14b8a6",label:"Бирюзовый"},{name:"sky",color:"#0ea5e9",label:"Небесный"},{name:"slate",color:"#64748b",label:"Сланцевый"}],Pn=()=>{if(typeof window>"u")return null;const m=localStorage.getItem("logoConfig");return m?JSON.parse(m):null},q=w(Pn()||{type:"preset",preset:"orange",color:"cyan",customSvg:null});function $e(){const m=f=>{q.value={type:"preset",preset:f,color:null,customSvg:null},I()},n=f=>{q.value={type:"dynamic",preset:null,color:f,customSvg:null},I()},t=f=>{q.value={type:"custom",preset:null,color:null,customSvg:f},I()},e=()=>{q.value={type:"preset",preset:"orange",color:null,customSvg:null},I()},I=()=>{typeof window<"u"&&localStorage.setItem("logoConfig",JSON.stringify(q.value))},k=L(()=>{if(q.value.type==="dynamic"){const f=Ze.find(u=>u.name===q.value.color);return(f==null?void 0:f.color)||"#06b6d4"}return null}),y=L(()=>q.value.type==="preset"?Ye.find(f=>f.name===q.value.preset):null),r=L(()=>q.value.type==="custom"),g=L(()=>q.value.type==="preset"),M=L(()=>q.value.type==="dynamic"),o=L(()=>q.value.type==="custom"&&q.value.customSvg?q.value.customSvg:null);return{logoConfig:q,presetLogos:Ye,dynamicLogoColors:Ze,setPresetLogo:m,setDynamicColor:n,setCustomLogo:t,resetLogo:e,getCurrentColor:k,getCurrentPreset:y,isCustomLogo:r,isPresetLogo:g,isDynamicLogo:M,getLogoSvg:o}}const Rn={__name:"LogoDisplay",props:{width:{type:String,default:"200"},height:{type:String,default:"40"}},setup(m,{expose:n}){n();const t=m,{getCurrentColor:e,getCurrentPreset:I,isCustomLogo:k,isPresetLogo:y,isDynamicLogo:r,getLogoSvg:g}=$e(),M=L(()=>e.value||"var(--primary-color)"),o={props:t,getCurrentColor:e,getCurrentPreset:I,isCustomLogo:k,isPresetLogo:y,isDynamicLogo:r,getLogoSvg:g,logoColor:M,get useLogo(){return $e},computed:L};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}},On=["innerHTML"],En=["src","alt"],Nn=["width","height"],Kn={transform:"translate(0 -20)"},Vn=["fill"],Un=["fill"],Bn=["fill"],jn=["fill"],Fn=["fill"],Wn=["fill"],zn=["fill"];function Jn(m,n,t,e,I,k){return e.isCustomLogo&&e.getLogoSvg?(c(),_("div",{key:0,innerHTML:e.getLogoSvg,class:"custom-logo-container"},null,8,On)):e.isPresetLogo&&e.getCurrentPreset?(c(),_("img",{key:1,src:e.getCurrentPreset.file,alt:e.getCurrentPreset.label,style:rt({height:t.height+"px",width:"auto"}),class:"preset-logo"},null,12,En)):(c(),_("svg",{key:2,width:t.width,height:t.height,viewBox:"0 0 512 60",xmlns:"http://www.w3.org/2000/svg",style:{overflow:"visible"}},[i("g",Kn,[i("path",{d:"M7.67 16.58c3.08-.62 6.22-.99 9.37-.9 8.94.14 18.1-.65 26.82 1.77 7.63 2.86 14.49 8.13 18.76 15.12 6.42 11.56 6.29 26.83-1.41 37.77-4.52 6.21-10.87 11.26-18.29 13.5-2.86.96-5.83 1.72-8.88 1.65-8.82-.05-17.64.05-26.46-.14-.06-4.25-.05-8.5-.03-12.74 7.81-.08 15.62.02 23.43.01 9.06.55 17.61-5.5 21.44-13.51.11-.52.31-1.58.42-2.11 1.44-5.52 1.18-11.77-1.68-16.82-2.57-4.85-7.06-8.47-12.1-10.53-10.38-1.97-20.99-.41-31.48-1.08.09-4 .1-8 .09-11.99z",fill:e.logoColor},null,8,Vn),i("path",{d:"M78.36 16.41c10.56.19 21.15-.38 31.69.36 1.32.4 2.65.73 4 1.06 7.81 2.09 14.51 8.11 16.31 16.16 1.08 7.14-1.82 14.45-7.12 19.27-1.72 1.67-4.5 2.86-3.99 5.71 4.92 3.24 7.89 8.65 9.92 14.03.32.97.64 1.94.97 2.9 1.36 3.15 2.86 6.25 3.76 9.57-5.04.03-10.07.01-15.11-.05-.84-2.52-1.69-5.04-2.53-7.56-.48-1.27-.94-2.54-1.39-3.81-1.81-4.52-5.3-8.04-9.51-10.37-8.86-2-17.8.17-26.74-.3-.27-1.1-.52-2.2-.78-3.29.67-3.17.48-6.42.44-9.63 5.82-1.29 11.86-.77 17.76-.35 3.65-.23 7.29-.56 10.94-.86 1.1-.35 2.21-.67 3.32-.96 1.74-1.3 3.37-2.73 4.91-4.26.38-.99.77-1.98 1.17-2.95.04-1.81.06-3.61.1-5.41-1.78-2.31-3.88-4.35-6.2-6.1-10.63-.51-21.27-.12-31.9-.15-.11-4.34-.09-8.68-.02-13.01z",fill:e.logoColor},null,8,Un),i("path",{d:"M158.05 19.37c7.46-4.61 16.58-4.51 25.01-3.68 9.98 1.95 19.03 8.35 23.97 17.27 4.9 8.53 5.81 19.07 3.22 28.47-5.47 19.22-28.89 30.28-47.37 22.84-9.98-3.86-18.62-11.81-22.2-22.02-1.83-5.57-2.89-11.63-1.36-17.39 2.03-10.78 9.53-19.9 18.73-25.49z",fill:e.logoColor},null,8,Bn),n[0]||(n[0]=i("path",{class:"pulsing-path",d:"m 169.00438,40.595867 c 2.62405,-1.508147 5.83199,-1.475432 8.79723,-1.2039 3.51045,0.637936 6.69378,2.731675 8.43141,5.649823 1.72357,2.790562 2.04366,6.238688 1.13263,9.313867 -1.92406,6.28776 -10.16201,9.906002 -16.66232,7.472031 -3.51045,-1.262787 -6.54956,-3.863603 -7.80882,-7.203771 -0.6437,-1.822207 -1.01655,-3.804716 -0.47838,-5.689081 0.71405,-3.526641 3.35217,-6.510219 6.58825-8.338969 z",fill:"var(--surface-card)",id:"svg_5-3",opacity:"1",style:{fill:"var(--surface-card)"}},null,-1)),i("path",{d:"M267.64 16.52c4.57-.23 9.15-.21 13.72.01.12 22.65.09 45.3-.02 67.94-2.92 2.07-7.22.39-10.68.97-8.66-10.49-16.56-21.59-24.86-32.37-2.59-3.69-5.78-6.94-8.14-10.8-.45 1.87-1.02 3.75-.96 5.7-.1 12.48.11 24.96-.15 37.44-4.33-.26-8.84.58-13.02-.9.26-22.66-.03-45.34-.01-68 3.22-.04 6.43-.05 9.65-.03 11.62 13.06 21.97 27.18 32.72 40.96.37.02 1.1.07 1.46.09.27-13.67.16-27.34.29-41.01z",fill:e.logoColor},null,8,jn),i("path",{d:"M293.62 16.46c6.13-.2 12.26-.07 18.39-.09 5.69.11 11.53-.44 17.02 1.42 9.76 3.45 17.85 11.27 21.28 21.08 2.57 10.12 2.65 21.91-3.73 30.7-5.37 8.13-14.08 13.67-23.55 15.72-9.56.39-19.13.01-28.7.18-.12-4.32-.11-8.64.02-12.95 7.9.04 15.8.12 23.7.04 2.12.04 4.14-.61 6.15-1.2 5.82-2.2 10.64-6.52 13.23-12.21 1.82-4.87 1.35-10.15.91-15.22-2.43-6.84-7.88-12.76-15.2-14.21-9.8-1.43-19.87.65-29.61-1.16.14-4.03.12-8.07.09-12.1z",fill:e.logoColor},null,8,Fn),i("path",{d:"M378.34 21.17c8.25-5.8 18.94-6.86 28.64-5.05 2.04.52 4.04 1.2 5.98 2.04 8.24 3.7 15.46 10.43 18.87 18.88.47 1.3.93 2.6 1.42 3.9 2.1 8.33 2.07 17.47-1.86 25.28-4.18 7.91-10.89 14.7-19.28 18.06-7.69 2.85-16.26 3.08-24.16.97-8.75-2.63-16.01-8.89-20.97-16.42-4.96-7.93-5.63-17.83-3.82-26.8.12-.53.38-1.59.5-2.12 2.63-7.67 8.27-13.96 14.68-18.74z",fill:e.logoColor},null,8,Wn),i("path",{d:"M445.77 39.99c5.84-14.09 20.79-24.4 36.22-23.48 6.96 0 13.92.02 20.89-.06.47 4.3 1.12 8.81-.21 13.02-9.19-.09-18.44-.54-27.6.28-1.04.37-2.09.73-3.13 1.06-6.94 2.86-12.34 8.88-14.28 16.15-.46 4.42-.51 8.96.97 13.21 1.33 2.33 2.8 4.59 4.39 6.76 2.69 2.22 5.59 4.18 8.87 5.41 10.31.32 20.62.17 30.93.11.59 4.32.88 8.79-.15 13.07-7.87-.13-15.75-.26-23.62-.2-4.36.06-8.79-.38-12.9-1.86-10.09-4.25-17.46-13.34-21.03-23.53-2.11-6.57-1.41-13.47.65-19.94z",fill:e.logoColor},null,8,zn)])],8,Nn))}const Hn=ae(Rn,[["render",Jn],["__scopeId","data-v-da7fd4af"],["__file","/home/hive/integram-standalone/src/components/LogoDisplay.vue"]]),qn={__name:"FlagRU",props:{width:{type:[String,Number],default:24},height:{type:[String,Number],default:16}},setup(m,{expose:n}){n();const t={};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}},Gn=["width","height"];function Qn(m,n,t,e,I,k){return c(),_("svg",{width:t.width,height:t.height,viewBox:"0 0 900 600",xmlns:"http://www.w3.org/2000/svg"},[...n[0]||(n[0]=[i("rect",{fill:"#fff",width:"900",height:"600"},null,-1),i("rect",{fill:"#0039a6",y:"200",width:"900",height:"200"},null,-1),i("rect",{fill:"#d52b1e",y:"400",width:"900",height:"200"},null,-1)])],8,Gn)}const et=ae(qn,[["render",Qn],["__file","/home/hive/integram-standalone/src/components/flags/FlagRU.vue"]]),Xn={__name:"FlagGB",props:{width:{type:[String,Number],default:24},height:{type:[String,Number],default:16}},setup(m,{expose:n}){n();const t={};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}},Yn=["width","height"];function Zn(m,n,t,e,I,k){return c(),_("svg",{width:t.width,height:t.height,viewBox:"0 0 60 30",xmlns:"http://www.w3.org/2000/svg"},[...n[0]||(n[0]=[st('<clipPath id="s"><path d="M0,0 v30 h60 v-30 z"></path></clipPath><clipPath id="t"><path d="M30,15 h30 v15 z v15 h-30 z h-30 v-15 z v-15 h30 z"></path></clipPath><g clip-path="url(#s)"><path d="M0,0 v30 h60 v-30 z" fill="#012169"></path><path d="M0,0 L60,30 M60,0 L0,30" stroke="#fff" stroke-width="6"></path><path d="M0,0 L60,30 M60,0 L0,30" clip-path="url(#t)" stroke="#C8102E" stroke-width="4"></path><path d="M30,0 v30 M0,15 h60" stroke="#fff" stroke-width="10"></path><path d="M30,0 v30 M0,15 h60" stroke="#C8102E" stroke-width="6"></path></g>',3)])],8,Yn)}const tt=ae(Xn,[["render",Zn],["__file","/home/hive/integram-standalone/src/components/flags/FlagGB.vue"]]),$n={__name:"FlagCN",props:{width:{type:[String,Number],default:24},height:{type:[String,Number],default:16}},setup(m,{expose:n}){n();const t={};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}},eo=["width","height"];function to(m,n,t,e,I,k){return c(),_("svg",{width:t.width,height:t.height,viewBox:"0 0 900 600",xmlns:"http://www.w3.org/2000/svg"},[...n[0]||(n[0]=[st('<defs><path id="star" d="M0,-1 L0.58778,0.80902 L-0.95106,-0.30902 L0.95106,-0.30902 L-0.58778,0.80902 z" fill="#ffde00"></path></defs><rect fill="#de2910" width="900" height="600"></rect><use href="#star" transform="translate(150,150) scale(60)"></use><use href="#star" transform="translate(240,60) scale(20) rotate(23.036243)"></use><use href="#star" transform="translate(270,120) scale(20) rotate(45.869898)"></use><use href="#star" transform="translate(270,180) scale(20) rotate(69.945396)"></use><use href="#star" transform="translate(240,240) scale(20) rotate(20.659808)"></use>',7)])],8,eo)}const nt=ae($n,[["render",to],["__file","/home/hive/integram-standalone/src/components/flags/FlagCN.vue"]]),no={__name:"LanguageSwitcher",setup(m,{expose:n}){n();const{locale:t}=Pe(),e=[{code:"ru",name:"Русский",flagComponent:et},{code:"en",name:"English",flagComponent:tt},{code:"zh",name:"中文",flagComponent:nt}],I=w(t.value),k=w(),y=L(()=>e.find(f=>f.code===I.value)||e[0]),r=f=>{k.value.toggle(f)},g=f=>{t.value=f,I.value=f,localStorage.setItem("locale",f),document.documentElement.setAttribute("lang",f)},M=f=>{g(f),k.value.hide()};W(t,f=>{I.value=f});const o={locale:t,locales:e,currentLocale:I,op:k,currentLocaleData:y,toggle:r,changeLocale:g,selectLocale:M,ref:w,watch:W,computed:L,get useI18n(){return Pe},FlagRU:et,FlagGB:tt,FlagCN:nt};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}},oo={class:"language-switcher"},ao=["title"],lo={class:"flag-display"},io={class:"language-menu"},ro=["onClick"],so={class:"flag-display"},uo={class:"locale-name"},co={key:0,class:"pi pi-check check-icon"};function mo(m,n,t,e,I,k){const y=te("Popover");return c(),_("div",oo,[i("button",{onClick:e.toggle,class:"language-button",title:e.currentLocaleData.name,type:"button"},[i("span",lo,[(c(),G(Be(e.currentLocaleData.flagComponent),{width:20,height:14}))])],8,ao),T(y,{ref:"op",class:"language-popover"},{default:F(()=>[i("div",io,[(c(),_(me,null,Le(e.locales,r=>i("button",{key:r.code,onClick:g=>e.selectLocale(r.code),class:U(["language-item",{active:e.currentLocale===r.code}]),type:"button"},[i("span",so,[(c(),G(Be(r.flagComponent),{width:20,height:14}))]),i("span",uo,Z(r.name),1),e.currentLocale===r.code?(c(),_("i",co)):A("",!0)],10,ro)),64))])]),_:1},512)])}const go=ae(no,[["render",mo],["__scopeId","data-v-1568d5fa"],["__file","/home/hive/integram-standalone/src/components/LanguageSwitcher.vue"]]);function ot(){const m=w([]),n=w(0);return{notifications:m,unreadCount:n,markAsRead:()=>{},clearAll:()=>{}}}const at=dt("workspaceAgent",()=>{const m=w([]),n=L(()=>m.value.length),t=L(()=>m.value.length>0);return{runningAgents:m,runningAgentsCount:n,hasActiveAgents:t}}),fo={__name:"AppTopbar",emits:["chat-toggle"],setup(m,{expose:n,emit:t}){n();const e=de(()=>Se(()=>import("./AppConfigurator-DhaJZLJw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),I=de(()=>Se(()=>import("./Profile-B2LB9zTX.js"),__vite__mapDeps([11,1,2,4,5,6,12]))),k=de(()=>Se(()=>import("./NotificationCenter-D27q8ZhZ.js"),__vite__mapDeps([13,1,2,14]))),y=de(()=>Se(()=>import("./AgentStatusPanel-CjZ-cNgd.js"),__vite__mapDeps([15,1,2,3,4,5,6,7,8,9,16]))),{t:r}=Pe(),{toggleMenu:g,toggleDarkMode:M,isDarkTheme:o}=fe(),{unreadCount:f}=ot(),{setInterval:u}=We();let h;try{h=at()}catch(C){console.warn("[AppTopbar] Pinia not ready, deferring workspaceAgentStore access:",C.message),h=null}const p=w(),R=w(!1),O=w(!1),j=w(!1),B=w(localStorage.getItem("currentUserPhoto")||""),z=t,Q=L(()=>(h==null?void 0:h.runningAgentsCount)||0),X=L(()=>(h==null?void 0:h.hasActiveAgents)||!1),le=()=>{R.value=!R.value},K=()=>{O.value=!O.value},V=()=>{j.value=!j.value},ne=w(localStorage.getItem("chat")==="true"),Ie=()=>{const P=!(localStorage.getItem("chat")==="true");localStorage.setItem("chat",P.toString()),ne.value=P,x.debug(P),z("chat-toggle",P)},ie=C=>{C.key==="chat"&&(ne.value=C.newValue==="true")},Ce=C=>{p.value&&typeof p.value.toggle=="function"&&p.value.toggle(C)},ue=()=>{const C=document.querySelector("link[rel*='icon']");C&&(C.href=o.value?"/app/meta/icon2.svg":"/app/meta/icon1.svg?upd")},xe=L(()=>o.value?r("theme.light","Включить светлую"):r("theme.dark","Включить тёмную")),pe=L(()=>r("theme.settings","Настройки темы")),ve=L(()=>r("notifications.title","Уведомления")),_e=L(()=>r("nav.chat","Чат")),Me=L(()=>r("nav.profile","Профиль")),he=L(()=>{const C=Q.value;return C===0?r("agents.noRunning","Нет запущенных агентов"):r("agents.running","Запущено агентов")+`: ${C}`});W(o,ue);const a=()=>{B.value=localStorage.getItem("currentUserPhoto")||""},d=C=>{C.key==="currentUserPhoto"&&a()};let s=null;const S=async()=>{var Y;const C=localStorage.getItem("my_token")||localStorage.getItem("token"),P=localStorage.getItem("id");if(!(!C||!P)){if(localStorage.getItem("currentUserPhoto")){B.value=localStorage.getItem("currentUserPhoto");return}try{const D=await fetch(`/api/profile/${P}`,{headers:{"X-Authorization":C}});if(D.ok){const E=await D.json();E.success&&((Y=E.data)!=null&&Y.photo)&&(B.value=E.data.photo,localStorage.setItem(`userPhoto_${P}`,E.data.photo),localStorage.setItem("currentUserPhoto",E.data.photo))}}catch(D){x.debug("Failed to fetch user photo on mount:",D)}}};se(()=>{ue(),window.addEventListener("storage",ie),window.addEventListener("storage",d),u(a,3e3)}),ge(()=>{window.removeEventListener("storage",ie),window.removeEventListener("storage",d)});const b={AppConfigurator:e,ProfileMenu:I,NotificationCenter:k,AgentStatusPanel:y,t:r,toggleMenu:g,toggleDarkMode:M,isDarkTheme:o,unreadCount:f,setTimerInterval:u,get workspaceAgentStore(){return h},set workspaceAgentStore(C){h=C},profileOverlay:p,notificationVisible:R,agentPanelVisible:O,configuratorVisible:j,userPhoto:B,emit:z,runningAgentsCount:Q,hasActiveAgents:X,toggleNotifications:le,toggleAgentPanel:K,toggleConfigurator:V,isChatOpen:ne,handleChat:Ie,handleChatStorageChange:ie,handleToggle:Ce,updateFavicon:ue,themeTooltip:xe,themeSettingsTooltip:pe,notificationsTooltip:ve,chatTooltip:_e,profileTooltip:Me,agentsTooltip:he,updateUserPhoto:a,handlePhotoStorageChange:d,get photoUpdateInterval(){return s},set photoUpdateInterval(C){s=C},fetchUserPhotoOnMount:S,get logger(){return x},get useLayout(){return fe},get Badge(){return ft},get Avatar(){return gt},defineAsyncComponent:de,LogoDisplay:Hn,LanguageSwitcher:go,get useNotifications(){return ot},get useWorkspaceAgentStore(){return at},get useI18n(){return Pe},onMounted:se,onUnmounted:ge,ref:w,watch:W,computed:L,nextTick:mt,get useTimer(){return We}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}},po={class:"layout-topbar"},vo={class:"layout-topbar-logo-container"},ho={class:"layout-topbar-actions"},yo={class:"layout-config-menu"},bo=["title"],_o=["title"],ko=["title"],So={class:"layout-topbar-menu-button layout-topbar-action"},wo={class:"layout-topbar-menu hidden lg:block"},Io={class:"layout-topbar-menu-content"},Co=["title"],xo=["title"],Mo=["title"],Ao={key:1,class:"pi pi-user"};function Lo(m,n,t,e,I,k){const y=te("router-link"),r=Oe("styleclass");return c(),_("div",po,[i("div",vo,[i("button",{class:"layout-menu-button layout-topbar-action",onClick:n[0]||(n[0]=(...g)=>e.toggleMenu&&e.toggleMenu(...g))},[...n[9]||(n[9]=[i("i",{class:"pi pi-bars"},null,-1)])]),T(y,{to:"/",class:"layout-topbar-logo"},{default:F(()=>[T(e.LogoDisplay,{width:"200",height:"40"})]),_:1})]),i("div",ho,[i("div",yo,[T(e.LanguageSwitcher),i("button",{type:"button",class:"layout-topbar-action relative",onClick:e.toggleAgentPanel,title:e.agentsTooltip},[i("i",{class:U(["pi pi-bolt",{"agent-active":e.hasActiveAgents}])},null,2),e.runningAgentsCount>0?(c(),G(e.Badge,{key:0,value:e.runningAgentsCount>99?"99+":e.runningAgentsCount.toString(),severity:e.hasActiveAgents?"success":"secondary",class:"agent-badge-topbar"},null,8,["value","severity"])):A("",!0)],8,bo),i("button",{type:"button",class:"layout-topbar-action",onClick:n[1]||(n[1]=(...g)=>e.toggleDarkMode&&e.toggleDarkMode(...g)),title:e.themeTooltip},[i("i",{class:U(["pi",{"pi-moon":e.isDarkTheme,"pi-sun":!e.isDarkTheme}])},null,2)],8,_o),i("button",{type:"button",class:"layout-topbar-action layout-topbar-action-highlight",onClick:e.toggleConfigurator,title:e.themeSettingsTooltip},[...n[10]||(n[10]=[i("i",{class:"pi pi-palette"},null,-1)])],8,ko)]),be((c(),_("button",So,[...n[11]||(n[11]=[i("i",{class:"pi pi-ellipsis-v"},null,-1)])])),[[r,{selector:"@next",enterFromClass:"hidden",enterActiveClass:"animate-scalein",leaveToClass:"hidden",leaveActiveClass:"animate-fadeout",hideOnOutsideClick:!0}]]),i("div",wo,[i("div",Io,[i("button",{onClick:e.toggleNotifications,type:"button",class:"layout-topbar-action relative",title:e.notificationsTooltip},[n[12]||(n[12]=i("i",{class:"pi pi-bell"},null,-1)),e.unreadCount>0?(c(),G(e.Badge,{key:0,value:e.unreadCount>99?"99+":e.unreadCount.toString(),severity:"danger",class:"notification-badge-topbar"},null,8,["value"])):A("",!0),i("span",null,Z(m.$t("notifications.title","Уведомления")),1)],8,Co),i("button",{onClick:e.handleChat,type:"button",class:U(["layout-topbar-action",{active:e.isChatOpen}]),title:e.chatTooltip},[n[13]||(n[13]=i("i",{class:"pi pi-comments"},null,-1)),i("span",null,Z(m.$t("nav.chat","Чат")),1)],10,xo),i("button",{onClick:n[2]||(n[2]=g=>e.handleToggle(g)),type:"button",class:"layout-topbar-action",title:e.profileTooltip},[e.userPhoto?(c(),G(e.Avatar,{key:0,image:e.userPhoto,shape:"circle",class:"topbar-avatar"},null,8,["image"])):(c(),_("i",Ao)),i("span",null,Z(m.$t("nav.profile","Профиль")),1)],8,Mo)])])]),T(e.ProfileMenu,{ref:"profileOverlay"},null,512),T(e.NotificationCenter,{visible:e.notificationVisible,"onUpdate:visible":n[3]||(n[3]=g=>e.notificationVisible=g),onClose:n[4]||(n[4]=g=>e.notificationVisible=!1)},null,8,["visible"]),T(e.AgentStatusPanel,{visible:e.agentPanelVisible,"onUpdate:visible":n[5]||(n[5]=g=>e.agentPanelVisible=g),onClose:n[6]||(n[6]=g=>e.agentPanelVisible=!1)},null,8,["visible"]),T(e.AppConfigurator,{visible:e.configuratorVisible,"onUpdate:visible":n[7]||(n[7]=g=>e.configuratorVisible=g),onClose:n[8]||(n[8]=g=>e.configuratorVisible=!1)},null,8,["visible"])])}const Do=ae(fo,[["render",Lo],["__scopeId","data-v-855a51f8"],["__file","/home/hive/integram-standalone/src/components/layout/AppTopbar.vue"]]),To={__name:"CookieConsentBanner",setup(m,{expose:n}){n();const t={};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}};function Po(m,n,t,e,I,k){return A("",!0)}const Ro=ae(To,[["render",Po],["__file","/home/hive/integram-standalone/src/components/legal/CookieConsentBanner.vue"]]),Oo={__name:"AppLayout",setup(m,{expose:n}){n();const t=de(()=>Se(()=>import("./Chat-CyOu8B_c.js"),__vite__mapDeps([17,1,2,18]))),e=de(()=>Se(()=>import("./ReleaseNotesModal-jiap4HDD.js"),__vite__mapDeps([19,1,2]))),I=we(),{layoutConfig:k,layoutState:y,isSidebarActive:r}=fe(),g=L(()=>(I==null?void 0:I.fullPath)||"/"),M=w(null),o=w(!1),f=w(parseInt(localStorage.getItem("chatWidth"))||320),u=w(!1),h=w(null),p=w(null),R=()=>typeof window>"u"?!1:window.innerWidth<=960;se(()=>{const K=window.localStorage.getItem("chat");K===null?(o.value=!R(),window.localStorage.setItem("chat",JSON.stringify(o.value))):o.value=JSON.parse(K),p.value=V=>{V.key==="chat"&&(o.value=V.newValue?JSON.parse(V.newValue):!1),V.key==="chatWidth"&&(f.value=parseInt(V.newValue)||320)},window.addEventListener("storage",p.value),h.value=setInterval(()=>{const V=parseInt(localStorage.getItem("chatWidth"))||320;V!==f.value&&(f.value=V)},100),setTimeout(()=>{const V=Re.version,ne=localStorage.getItem("lastSeenVersion");(!ne||ne!==V)&&(u.value=!0)},1e3)}),ge(()=>{h.value&&clearInterval(h.value),p.value&&window.removeEventListener("storage",p.value)}),W(r,K=>{K?j():B()});const O=L(()=>({"layout-overlay":k.menuMode==="overlay","layout-static":k.menuMode==="static","layout-static-inactive":y.staticMenuDesktopInactive&&k.menuMode==="static","layout-overlay-active":y.overlayMenuActive,"layout-mobile-active":y.staticMenuMobileActive,"chat-active":o.value&&k.menuMode==="static","sidebar-collapsed":y.sidebarCollapsed}));function j(){M.value||(M.value=K=>{z(K)&&(y.overlayMenuActive=!1,y.staticMenuMobileActive=!1,y.menuHoverActive=!1)},document.addEventListener("click",M.value))}function B(){M.value&&(document.removeEventListener("click",M.value),M.value=null)}function z(K){const V=document.querySelector(".layout-sidebar"),ne=document.querySelector(".layout-menu-button");return!(V.isSameNode(K.target)||V.contains(K.target)||ne.isSameNode(K.target)||ne.contains(K.target))}const Q=K=>{o.value=K,window.localStorage.setItem("chat",JSON.stringify(K))},X=L(()=>`${(f.value+32+32)/16}rem`),le={Chat:t,ReleaseNotesModal:e,route:I,layoutConfig:k,layoutState:y,isSidebarActive:r,safeRouteKey:g,outsideClickListener:M,isChatActive:o,chatWidth:f,showReleaseNotes:u,chatWidthInterval:h,storageHandler:p,isMobileDevice:R,containerClass:O,bindOutsideClickListener:j,unbindOutsideClickListener:B,isOutsideClicked:z,updateChatState:Q,chatMargin:X,get useLayout(){return fe},computed:L,ref:w,watch:W,onMounted:se,onUnmounted:ge,defineAsyncComponent:de,get useRoute(){return we},AppFooter:Bt,AppSidebar:Tn,AppTopbar:Do,CookieConsentBanner:Ro,get packageJson(){return Re},SafeRouterView:vt};return Object.defineProperty(le,"__isScriptSetup",{enumerable:!1,value:!0}),le}},Eo={class:"layout-main"};function No(m,n,t,e,I,k){const y=te("Toast");return c(),_(me,null,[i("div",{class:U(["layout-wrapper",e.containerClass])},[T(e.AppTopbar,{onChatToggle:e.updateChatState}),T(e.AppSidebar),T(it,{name:"slide-in-right"},{default:F(()=>[e.isChatActive?(c(),G(je,{key:0},{fallback:F(()=>[...n[1]||(n[1]=[i("div",{class:"chat-loading"},null,-1)])]),default:F(()=>[T(e.Chat)]),_:1})):A("",!0)]),_:1}),i("div",{class:"layout-main-container",style:rt(e.isChatActive&&e.layoutConfig.menuMode==="static"?{marginRight:e.chatMargin}:{})},[i("div",Eo,[(c(),G(e.SafeRouterView,{key:e.safeRouteKey}))]),T(e.AppFooter)],4),n[2]||(n[2]=i("div",{class:"layout-mask animate-fadein"},null,-1))],2),T(y),(c(),G(je,null,{fallback:F(()=>[...n[3]||(n[3]=[i("span",null,null,-1)])]),default:F(()=>[T(e.ReleaseNotesModal,{visible:e.showReleaseNotes,"onUpdate:visible":n[0]||(n[0]=r=>e.showReleaseNotes=r)},null,8,["visible"])]),_:1})),T(e.CookieConsentBanner)],64)}const Ko=ae(Oo,[["render",No],["__file","/home/hive/integram-standalone/src/components/layout/AppLayout.vue"]]),zo=Object.freeze(Object.defineProperty({__proto__:null,default:Ko},Symbol.toStringTag,{value:"Module"}));export{zo as A,$e as a,at as b,fe as u};
